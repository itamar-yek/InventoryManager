import{r as E,a as Is,u as et,b as tt,L as $e,O as Bs,N as $t,c as ls,d as Hs,B as Ws,e as zs,f as Fe,R as qs}from"./vendor-D40g8N90.js";import{c as cs}from"./state-9TSjvsSi.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var ds={exports:{}},gt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xs=E,Ys=Symbol.for("react.element"),Js=Symbol.for("react.fragment"),Vs=Object.prototype.hasOwnProperty,Ks=Xs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Zs={key:!0,ref:!0,__self:!0,__source:!0};function us(e,s,n){var r,a={},i=null,o=null;n!==void 0&&(i=""+n),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(o=s.ref);for(r in s)Vs.call(s,r)&&!Zs.hasOwnProperty(r)&&(a[r]=s[r]);if(e&&e.defaultProps)for(r in s=e.defaultProps,s)a[r]===void 0&&(a[r]=s[r]);return{$$typeof:Ys,type:e,key:i,ref:o,props:a,_owner:Ks.current}}gt.Fragment=Js;gt.jsx=us;gt.jsxs=us;ds.exports=gt;var t=ds.exports,kt={},Ht=Is;kt.createRoot=Ht.createRoot,kt.hydrateRoot=Ht.hydrateRoot;const Gs={};function Qs(e,s){let n;try{n=e()}catch{return}return{getItem:a=>{var i;const o=h=>h===null?null:JSON.parse(h,void 0),l=(i=n.getItem(a))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(a,i)=>n.setItem(a,JSON.stringify(i,void 0)),removeItem:a=>n.removeItem(a)}}const Qe=e=>s=>{try{const n=e(s);return n instanceof Promise?n:{then(r){return Qe(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Qe(r)(n)}}}},er=(e,s)=>(n,r,a)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,N)=>({...N,...x}),...s},o=!1;const l=new Set,h=new Set;let c;try{c=i.getStorage()}catch{}if(!c)return e((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...x)},r,a);const d=Qe(i.serialize),g=()=>{const x=i.partialize({...r()});let N;const y=d({state:x,version:i.version}).then(S=>c.setItem(i.name,S)).catch(S=>{N=S});if(N)throw N;return y},j=a.setState;a.setState=(x,N)=>{j(x,N),g()};const _=e((...x)=>{n(...x),g()},r,a);let m;const u=()=>{var x;if(!c)return;o=!1,l.forEach(y=>y(r()));const N=((x=i.onRehydrateStorage)==null?void 0:x.call(i,r()))||void 0;return Qe(c.getItem.bind(c))(i.name).then(y=>{if(y)return i.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate)return i.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var S;return m=i.merge(y,(S=r())!=null?S:_),n(m,!0),g()}).then(()=>{N==null||N(m,void 0),o=!0,h.forEach(y=>y(m))}).catch(y=>{N==null||N(void 0,y)})};return a.persist={setOptions:x=>{i={...i,...x},x.getStorage&&(c=x.getStorage())},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>u(),hasHydrated:()=>o,onHydrate:x=>(l.add(x),()=>{l.delete(x)}),onFinishHydration:x=>(h.add(x),()=>{h.delete(x)})},u(),m||_},tr=(e,s)=>(n,r,a)=>{let i={storage:Qs(()=>localStorage),partialize:u=>u,version:0,merge:(u,x)=>({...x,...u}),...s},o=!1;const l=new Set,h=new Set;let c=i.storage;if(!c)return e((...u)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...u)},r,a);const d=()=>{const u=i.partialize({...r()});return c.setItem(i.name,{state:u,version:i.version})},g=a.setState;a.setState=(u,x)=>{g(u,x),d()};const j=e((...u)=>{n(...u),d()},r,a);a.getInitialState=()=>j;let _;const m=()=>{var u,x;if(!c)return;o=!1,l.forEach(y=>{var S;return y((S=r())!=null?S:j)});const N=((x=i.onRehydrateStorage)==null?void 0:x.call(i,(u=r())!=null?u:j))||void 0;return Qe(c.getItem.bind(c))(i.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate)return[!0,i.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var S;const[D,Y]=y;if(_=i.merge(Y,(S=r())!=null?S:j),n(_,!0),D)return d()}).then(()=>{N==null||N(_,void 0),_=r(),o=!0,h.forEach(y=>y(_))}).catch(y=>{N==null||N(void 0,y)})};return a.persist={setOptions:u=>{i={...i,...u},u.storage&&(c=u.storage)},clearStorage:()=>{c==null||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>o,onHydrate:u=>(l.add(u),()=>{l.delete(u)}),onFinishHydration:u=>(h.add(u),()=>{h.delete(u)})},i.skipHydration||m(),_||j},sr=(e,s)=>"getStorage"in s||"serialize"in s||"deserialize"in s?((Gs?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),er(e,s)):tr(e,s),rr=sr;function hs(e,s){return function(){return e.apply(s,arguments)}}const{toString:nr}=Object.prototype,{getPrototypeOf:Ut}=Object,{iterator:bt,toStringTag:ms}=Symbol,yt=(e=>s=>{const n=nr.call(s);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ke=e=>(e=e.toLowerCase(),s=>yt(s)===e),jt=e=>s=>typeof s===e,{isArray:Ye}=Array,Xe=jt("undefined");function st(e){return e!==null&&!Xe(e)&&e.constructor!==null&&!Xe(e.constructor)&&je(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const fs=ke("ArrayBuffer");function ar(e){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(e):s=e&&e.buffer&&fs(e.buffer),s}const ir=jt("string"),je=jt("function"),ps=jt("number"),rt=e=>e!==null&&typeof e=="object",or=e=>e===!0||e===!1,mt=e=>{if(yt(e)!=="object")return!1;const s=Ut(e);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(ms in e)&&!(bt in e)},lr=e=>{if(!rt(e)||st(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},cr=ke("Date"),dr=ke("File"),ur=ke("Blob"),hr=ke("FileList"),mr=e=>rt(e)&&je(e.pipe),fr=e=>{let s;return e&&(typeof FormData=="function"&&e instanceof FormData||je(e.append)&&((s=yt(e))==="formdata"||s==="object"&&je(e.toString)&&e.toString()==="[object FormData]"))},pr=ke("URLSearchParams"),[xr,gr,br,yr]=["ReadableStream","Request","Response","Headers"].map(ke),jr=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function nt(e,s,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,a;if(typeof e!="object"&&(e=[e]),Ye(e))for(r=0,a=e.length;r<a;r++)s.call(null,e[r],r,e);else{if(st(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let l;for(r=0;r<o;r++)l=i[r],s.call(null,e[l],l,e)}}function xs(e,s){if(st(e))return null;s=s.toLowerCase();const n=Object.keys(e);let r=n.length,a;for(;r-- >0;)if(a=n[r],s===a.toLowerCase())return a;return null}const Ie=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,gs=e=>!Xe(e)&&e!==Ie;function At(){const{caseless:e,skipUndefined:s}=gs(this)&&this||{},n={},r=(a,i)=>{const o=e&&xs(n,i)||i;mt(n[o])&&mt(a)?n[o]=At(n[o],a):mt(a)?n[o]=At({},a):Ye(a)?n[o]=a.slice():(!s||!Xe(a))&&(n[o]=a)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&nt(arguments[a],r);return n}const wr=(e,s,n,{allOwnKeys:r}={})=>(nt(s,(a,i)=>{n&&je(a)?e[i]=hs(a,n):e[i]=a},{allOwnKeys:r}),e),Nr=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),vr=(e,s,n,r)=>{e.prototype=Object.create(s.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:s.prototype}),n&&Object.assign(e.prototype,n)},_r=(e,s,n,r)=>{let a,i,o;const l={};if(s=s||{},e==null)return s;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!r||r(o,e,s))&&!l[o]&&(s[o]=e[o],l[o]=!0);e=n!==!1&&Ut(e)}while(e&&(!n||n(e,s))&&e!==Object.prototype);return s},Sr=(e,s,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=s.length;const r=e.indexOf(s,n);return r!==-1&&r===n},Lr=e=>{if(!e)return null;if(Ye(e))return e;let s=e.length;if(!ps(s))return null;const n=new Array(s);for(;s-- >0;)n[s]=e[s];return n},Er=(e=>s=>e&&s instanceof e)(typeof Uint8Array<"u"&&Ut(Uint8Array)),Rr=(e,s)=>{const r=(e&&e[bt]).call(e);let a;for(;(a=r.next())&&!a.done;){const i=a.value;s.call(e,i[0],i[1])}},$r=(e,s)=>{let n;const r=[];for(;(n=e.exec(s))!==null;)r.push(n);return r},kr=ke("HTMLFormElement"),Ar=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,a){return r.toUpperCase()+a}),Wt=(({hasOwnProperty:e})=>(s,n)=>e.call(s,n))(Object.prototype),Tr=ke("RegExp"),bs=(e,s)=>{const n=Object.getOwnPropertyDescriptors(e),r={};nt(n,(a,i)=>{let o;(o=s(a,i,e))!==!1&&(r[i]=o||a)}),Object.defineProperties(e,r)},Or=e=>{bs(e,(s,n)=>{if(je(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(je(r)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Cr=(e,s)=>{const n={},r=a=>{a.forEach(i=>{n[i]=!0})};return Ye(e)?r(e):r(String(e).split(s)),n},Ur=()=>{},Fr=(e,s)=>e!=null&&Number.isFinite(e=+e)?e:s;function Pr(e){return!!(e&&je(e.append)&&e[ms]==="FormData"&&e[bt])}const Dr=e=>{const s=new Array(10),n=(r,a)=>{if(rt(r)){if(s.indexOf(r)>=0)return;if(st(r))return r;if(!("toJSON"in r)){s[a]=r;const i=Ye(r)?[]:{};return nt(r,(o,l)=>{const h=n(o,a+1);!Xe(h)&&(i[l]=h)}),s[a]=void 0,i}}return r};return n(e,0)},Mr=ke("AsyncFunction"),Ir=e=>e&&(rt(e)||je(e))&&je(e.then)&&je(e.catch),ys=((e,s)=>e?setImmediate:s?((n,r)=>(Ie.addEventListener("message",({source:a,data:i})=>{a===Ie&&i===n&&r.length&&r.shift()()},!1),a=>{r.push(a),Ie.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",je(Ie.postMessage)),Br=typeof queueMicrotask<"u"?queueMicrotask.bind(Ie):typeof process<"u"&&process.nextTick||ys,Hr=e=>e!=null&&je(e[bt]),f={isArray:Ye,isArrayBuffer:fs,isBuffer:st,isFormData:fr,isArrayBufferView:ar,isString:ir,isNumber:ps,isBoolean:or,isObject:rt,isPlainObject:mt,isEmptyObject:lr,isReadableStream:xr,isRequest:gr,isResponse:br,isHeaders:yr,isUndefined:Xe,isDate:cr,isFile:dr,isBlob:ur,isRegExp:Tr,isFunction:je,isStream:mr,isURLSearchParams:pr,isTypedArray:Er,isFileList:hr,forEach:nt,merge:At,extend:wr,trim:jr,stripBOM:Nr,inherits:vr,toFlatObject:_r,kindOf:yt,kindOfTest:ke,endsWith:Sr,toArray:Lr,forEachEntry:Rr,matchAll:$r,isHTMLForm:kr,hasOwnProperty:Wt,hasOwnProp:Wt,reduceDescriptors:bs,freezeMethods:Or,toObjectSet:Cr,toCamelCase:Ar,noop:Ur,toFiniteNumber:Fr,findKey:xs,global:Ie,isContextDefined:gs,isSpecCompliantForm:Pr,toJSONObject:Dr,isAsyncFn:Mr,isThenable:Ir,setImmediate:ys,asap:Br,isIterable:Hr};function O(e,s,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",s&&(this.code=s),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}f.inherits(O,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:f.toJSONObject(this.config),code:this.code,status:this.status}}});const js=O.prototype,ws={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ws[e]={value:e}});Object.defineProperties(O,ws);Object.defineProperty(js,"isAxiosError",{value:!0});O.from=(e,s,n,r,a,i)=>{const o=Object.create(js);f.toFlatObject(e,o,function(d){return d!==Error.prototype},c=>c!=="isAxiosError");const l=e&&e.message?e.message:"Error",h=s==null&&e?e.code:s;return O.call(o,l,h,n,r,a),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const Wr=null;function Tt(e){return f.isPlainObject(e)||f.isArray(e)}function Ns(e){return f.endsWith(e,"[]")?e.slice(0,-2):e}function zt(e,s,n){return e?e.concat(s).map(function(a,i){return a=Ns(a),!n&&i?"["+a+"]":a}).join(n?".":""):s}function zr(e){return f.isArray(e)&&!e.some(Tt)}const qr=f.toFlatObject(f,{},null,function(s){return/^is[A-Z]/.test(s)});function wt(e,s,n){if(!f.isObject(e))throw new TypeError("target must be an object");s=s||new FormData,n=f.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(u,x){return!f.isUndefined(x[u])});const r=n.metaTokens,a=n.visitor||d,i=n.dots,o=n.indexes,h=(n.Blob||typeof Blob<"u"&&Blob)&&f.isSpecCompliantForm(s);if(!f.isFunction(a))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(f.isDate(m))return m.toISOString();if(f.isBoolean(m))return m.toString();if(!h&&f.isBlob(m))throw new O("Blob is not supported. Use a Buffer instead.");return f.isArrayBuffer(m)||f.isTypedArray(m)?h&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,u,x){let N=m;if(m&&!x&&typeof m=="object"){if(f.endsWith(u,"{}"))u=r?u:u.slice(0,-2),m=JSON.stringify(m);else if(f.isArray(m)&&zr(m)||(f.isFileList(m)||f.endsWith(u,"[]"))&&(N=f.toArray(m)))return u=Ns(u),N.forEach(function(S,D){!(f.isUndefined(S)||S===null)&&s.append(o===!0?zt([u],D,i):o===null?u:u+"[]",c(S))}),!1}return Tt(m)?!0:(s.append(zt(x,u,i),c(m)),!1)}const g=[],j=Object.assign(qr,{defaultVisitor:d,convertValue:c,isVisitable:Tt});function _(m,u){if(!f.isUndefined(m)){if(g.indexOf(m)!==-1)throw Error("Circular reference detected in "+u.join("."));g.push(m),f.forEach(m,function(N,y){(!(f.isUndefined(N)||N===null)&&a.call(s,N,f.isString(y)?y.trim():y,u,j))===!0&&_(N,u?u.concat(y):[y])}),g.pop()}}if(!f.isObject(e))throw new TypeError("data must be an object");return _(e),s}function qt(e){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return s[r]})}function Ft(e,s){this._pairs=[],e&&wt(e,this,s)}const vs=Ft.prototype;vs.append=function(s,n){this._pairs.push([s,n])};vs.toString=function(s){const n=s?function(r){return s.call(this,r,qt)}:qt;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function Xr(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function _s(e,s,n){if(!s)return e;const r=n&&n.encode||Xr;f.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let i;if(a?i=a(s,n):i=f.isURLSearchParams(s)?s.toString():new Ft(s,n).toString(r),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Xt{constructor(){this.handlers=[]}use(s,n,r){return this.handlers.push({fulfilled:s,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){f.forEach(this.handlers,function(r){r!==null&&s(r)})}}const Ss={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Yr=typeof URLSearchParams<"u"?URLSearchParams:Ft,Jr=typeof FormData<"u"?FormData:null,Vr=typeof Blob<"u"?Blob:null,Kr={isBrowser:!0,classes:{URLSearchParams:Yr,FormData:Jr,Blob:Vr},protocols:["http","https","file","blob","url","data"]},Pt=typeof window<"u"&&typeof document<"u",Ot=typeof navigator=="object"&&navigator||void 0,Zr=Pt&&(!Ot||["ReactNative","NativeScript","NS"].indexOf(Ot.product)<0),Gr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Qr=Pt&&window.location.href||"http://localhost",en=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Pt,hasStandardBrowserEnv:Zr,hasStandardBrowserWebWorkerEnv:Gr,navigator:Ot,origin:Qr},Symbol.toStringTag,{value:"Module"})),pe={...en,...Kr};function tn(e,s){return wt(e,new pe.classes.URLSearchParams,{visitor:function(n,r,a,i){return pe.isNode&&f.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...s})}function sn(e){return f.matchAll(/\w+|\[(\w*)]/g,e).map(s=>s[0]==="[]"?"":s[1]||s[0])}function rn(e){const s={},n=Object.keys(e);let r;const a=n.length;let i;for(r=0;r<a;r++)i=n[r],s[i]=e[i];return s}function Ls(e){function s(n,r,a,i){let o=n[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),h=i>=n.length;return o=!o&&f.isArray(a)?a.length:o,h?(f.hasOwnProp(a,o)?a[o]=[a[o],r]:a[o]=r,!l):((!a[o]||!f.isObject(a[o]))&&(a[o]=[]),s(n,r,a[o],i)&&f.isArray(a[o])&&(a[o]=rn(a[o])),!l)}if(f.isFormData(e)&&f.isFunction(e.entries)){const n={};return f.forEachEntry(e,(r,a)=>{s(sn(r),a,n,0)}),n}return null}function nn(e,s,n){if(f.isString(e))try{return(s||JSON.parse)(e),f.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const at={transitional:Ss,adapter:["xhr","http","fetch"],transformRequest:[function(s,n){const r=n.getContentType()||"",a=r.indexOf("application/json")>-1,i=f.isObject(s);if(i&&f.isHTMLForm(s)&&(s=new FormData(s)),f.isFormData(s))return a?JSON.stringify(Ls(s)):s;if(f.isArrayBuffer(s)||f.isBuffer(s)||f.isStream(s)||f.isFile(s)||f.isBlob(s)||f.isReadableStream(s))return s;if(f.isArrayBufferView(s))return s.buffer;if(f.isURLSearchParams(s))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return tn(s,this.formSerializer).toString();if((l=f.isFileList(s))||r.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return wt(l?{"files[]":s}:s,h&&new h,this.formSerializer)}}return i||a?(n.setContentType("application/json",!1),nn(s)):s}],transformResponse:[function(s){const n=this.transitional||at.transitional,r=n&&n.forcedJSONParsing,a=this.responseType==="json";if(f.isResponse(s)||f.isReadableStream(s))return s;if(s&&f.isString(s)&&(r&&!this.responseType||a)){const o=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(s,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?O.from(l,O.ERR_BAD_RESPONSE,this,null,this.response):l}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pe.classes.FormData,Blob:pe.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};f.forEach(["delete","get","head","post","put","patch"],e=>{at.headers[e]={}});const an=f.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),on=e=>{const s={};let n,r,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),n=o.substring(0,a).trim().toLowerCase(),r=o.substring(a+1).trim(),!(!n||s[n]&&an[n])&&(n==="set-cookie"?s[n]?s[n].push(r):s[n]=[r]:s[n]=s[n]?s[n]+", "+r:r)}),s},Yt=Symbol("internals");function Ge(e){return e&&String(e).trim().toLowerCase()}function ft(e){return e===!1||e==null?e:f.isArray(e)?e.map(ft):String(e)}function ln(e){const s=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)s[r[1]]=r[2];return s}const cn=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function vt(e,s,n,r,a){if(f.isFunction(r))return r.call(this,s,n);if(a&&(s=n),!!f.isString(s)){if(f.isString(r))return s.indexOf(r)!==-1;if(f.isRegExp(r))return r.test(s)}}function dn(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,n,r)=>n.toUpperCase()+r)}function un(e,s){const n=f.toCamelCase(" "+s);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(a,i,o){return this[r].call(this,s,a,i,o)},configurable:!0})})}let we=class{constructor(s){s&&this.set(s)}set(s,n,r){const a=this;function i(l,h,c){const d=Ge(h);if(!d)throw new Error("header name must be a non-empty string");const g=f.findKey(a,d);(!g||a[g]===void 0||c===!0||c===void 0&&a[g]!==!1)&&(a[g||h]=ft(l))}const o=(l,h)=>f.forEach(l,(c,d)=>i(c,d,h));if(f.isPlainObject(s)||s instanceof this.constructor)o(s,n);else if(f.isString(s)&&(s=s.trim())&&!cn(s))o(on(s),n);else if(f.isObject(s)&&f.isIterable(s)){let l={},h,c;for(const d of s){if(!f.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[c=d[0]]=(h=l[c])?f.isArray(h)?[...h,d[1]]:[h,d[1]]:d[1]}o(l,n)}else s!=null&&i(n,s,r);return this}get(s,n){if(s=Ge(s),s){const r=f.findKey(this,s);if(r){const a=this[r];if(!n)return a;if(n===!0)return ln(a);if(f.isFunction(n))return n.call(this,a,r);if(f.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,n){if(s=Ge(s),s){const r=f.findKey(this,s);return!!(r&&this[r]!==void 0&&(!n||vt(this,this[r],r,n)))}return!1}delete(s,n){const r=this;let a=!1;function i(o){if(o=Ge(o),o){const l=f.findKey(r,o);l&&(!n||vt(r,r[l],l,n))&&(delete r[l],a=!0)}}return f.isArray(s)?s.forEach(i):i(s),a}clear(s){const n=Object.keys(this);let r=n.length,a=!1;for(;r--;){const i=n[r];(!s||vt(this,this[i],i,s,!0))&&(delete this[i],a=!0)}return a}normalize(s){const n=this,r={};return f.forEach(this,(a,i)=>{const o=f.findKey(r,i);if(o){n[o]=ft(a),delete n[i];return}const l=s?dn(i):String(i).trim();l!==i&&delete n[i],n[l]=ft(a),r[l]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const n=Object.create(null);return f.forEach(this,(r,a)=>{r!=null&&r!==!1&&(n[a]=s&&f.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,n])=>s+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...n){const r=new this(s);return n.forEach(a=>r.set(a)),r}static accessor(s){const r=(this[Yt]=this[Yt]={accessors:{}}).accessors,a=this.prototype;function i(o){const l=Ge(o);r[l]||(un(a,o),r[l]=!0)}return f.isArray(s)?s.forEach(i):i(s),this}};we.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);f.reduceDescriptors(we.prototype,({value:e},s)=>{let n=s[0].toUpperCase()+s.slice(1);return{get:()=>e,set(r){this[n]=r}}});f.freezeMethods(we);function _t(e,s){const n=this||at,r=s||n,a=we.from(r.headers);let i=r.data;return f.forEach(e,function(l){i=l.call(n,i,a.normalize(),s?s.status:void 0)}),a.normalize(),i}function Es(e){return!!(e&&e.__CANCEL__)}function Je(e,s,n){O.call(this,e??"canceled",O.ERR_CANCELED,s,n),this.name="CanceledError"}f.inherits(Je,O,{__CANCEL__:!0});function Rs(e,s,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):s(new O("Request failed with status code "+n.status,[O.ERR_BAD_REQUEST,O.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function hn(e){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return s&&s[1]||""}function mn(e,s){e=e||10;const n=new Array(e),r=new Array(e);let a=0,i=0,o;return s=s!==void 0?s:1e3,function(h){const c=Date.now(),d=r[i];o||(o=c),n[a]=h,r[a]=c;let g=i,j=0;for(;g!==a;)j+=n[g++],g=g%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),c-o<s)return;const _=d&&c-d;return _?Math.round(j*1e3/_):void 0}}function fn(e,s){let n=0,r=1e3/s,a,i;const o=(c,d=Date.now())=>{n=d,a=null,i&&(clearTimeout(i),i=null),e(...c)};return[(...c)=>{const d=Date.now(),g=d-n;g>=r?o(c,d):(a=c,i||(i=setTimeout(()=>{i=null,o(a)},r-g)))},()=>a&&o(a)]}const xt=(e,s,n=3)=>{let r=0;const a=mn(50,250);return fn(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,h=o-r,c=a(h),d=o<=l;r=o;const g={loaded:o,total:l,progress:l?o/l:void 0,bytes:h,rate:c||void 0,estimated:c&&l&&d?(l-o)/c:void 0,event:i,lengthComputable:l!=null,[s?"download":"upload"]:!0};e(g)},n)},Jt=(e,s)=>{const n=e!=null;return[r=>s[0]({lengthComputable:n,total:e,loaded:r}),s[1]]},Vt=e=>(...s)=>f.asap(()=>e(...s)),pn=pe.hasStandardBrowserEnv?((e,s)=>n=>(n=new URL(n,pe.origin),e.protocol===n.protocol&&e.host===n.host&&(s||e.port===n.port)))(new URL(pe.origin),pe.navigator&&/(msie|trident)/i.test(pe.navigator.userAgent)):()=>!0,xn=pe.hasStandardBrowserEnv?{write(e,s,n,r,a,i,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(s)}`];f.isNumber(n)&&l.push(`expires=${new Date(n).toUTCString()}`),f.isString(r)&&l.push(`path=${r}`),f.isString(a)&&l.push(`domain=${a}`),i===!0&&l.push("secure"),f.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function gn(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function bn(e,s){return s?e.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):e}function $s(e,s,n){let r=!gn(s);return e&&(r||n==!1)?bn(e,s):s}const Kt=e=>e instanceof we?{...e}:e;function He(e,s){s=s||{};const n={};function r(c,d,g,j){return f.isPlainObject(c)&&f.isPlainObject(d)?f.merge.call({caseless:j},c,d):f.isPlainObject(d)?f.merge({},d):f.isArray(d)?d.slice():d}function a(c,d,g,j){if(f.isUndefined(d)){if(!f.isUndefined(c))return r(void 0,c,g,j)}else return r(c,d,g,j)}function i(c,d){if(!f.isUndefined(d))return r(void 0,d)}function o(c,d){if(f.isUndefined(d)){if(!f.isUndefined(c))return r(void 0,c)}else return r(void 0,d)}function l(c,d,g){if(g in s)return r(c,d);if(g in e)return r(void 0,c)}const h={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(c,d,g)=>a(Kt(c),Kt(d),g,!0)};return f.forEach(Object.keys({...e,...s}),function(d){const g=h[d]||a,j=g(e[d],s[d],d);f.isUndefined(j)&&g!==l||(n[d]=j)}),n}const ks=e=>{const s=He({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:l}=s;if(s.headers=o=we.from(o),s.url=_s($s(s.baseURL,s.url,s.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),f.isFormData(n)){if(pe.hasStandardBrowserEnv||pe.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(f.isFunction(n.getHeaders)){const h=n.getHeaders(),c=["content-type","content-length"];Object.entries(h).forEach(([d,g])=>{c.includes(d.toLowerCase())&&o.set(d,g)})}}if(pe.hasStandardBrowserEnv&&(r&&f.isFunction(r)&&(r=r(s)),r||r!==!1&&pn(s.url))){const h=a&&i&&xn.read(i);h&&o.set(a,h)}return s},yn=typeof XMLHttpRequest<"u",jn=yn&&function(e){return new Promise(function(n,r){const a=ks(e);let i=a.data;const o=we.from(a.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:c}=a,d,g,j,_,m;function u(){_&&_(),m&&m(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let x=new XMLHttpRequest;x.open(a.method.toUpperCase(),a.url,!0),x.timeout=a.timeout;function N(){if(!x)return;const S=we.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),Y={data:!l||l==="text"||l==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:S,config:e,request:x};Rs(function(v){n(v),u()},function(v){r(v),u()},Y),x=null}"onloadend"in x?x.onloadend=N:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(N)},x.onabort=function(){x&&(r(new O("Request aborted",O.ECONNABORTED,e,x)),x=null)},x.onerror=function(D){const Y=D&&D.message?D.message:"Network Error",M=new O(Y,O.ERR_NETWORK,e,x);M.event=D||null,r(M),x=null},x.ontimeout=function(){let D=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const Y=a.transitional||Ss;a.timeoutErrorMessage&&(D=a.timeoutErrorMessage),r(new O(D,Y.clarifyTimeoutError?O.ETIMEDOUT:O.ECONNABORTED,e,x)),x=null},i===void 0&&o.setContentType(null),"setRequestHeader"in x&&f.forEach(o.toJSON(),function(D,Y){x.setRequestHeader(Y,D)}),f.isUndefined(a.withCredentials)||(x.withCredentials=!!a.withCredentials),l&&l!=="json"&&(x.responseType=a.responseType),c&&([j,m]=xt(c,!0),x.addEventListener("progress",j)),h&&x.upload&&([g,_]=xt(h),x.upload.addEventListener("progress",g),x.upload.addEventListener("loadend",_)),(a.cancelToken||a.signal)&&(d=S=>{x&&(r(!S||S.type?new Je(null,e,x):S),x.abort(),x=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const y=hn(a.url);if(y&&pe.protocols.indexOf(y)===-1){r(new O("Unsupported protocol "+y+":",O.ERR_BAD_REQUEST,e));return}x.send(i||null)})},wn=(e,s)=>{const{length:n}=e=e?e.filter(Boolean):[];if(s||n){let r=new AbortController,a;const i=function(c){if(!a){a=!0,l();const d=c instanceof Error?c:this.reason;r.abort(d instanceof O?d:new Je(d instanceof Error?d.message:d))}};let o=s&&setTimeout(()=>{o=null,i(new O(`timeout ${s} of ms exceeded`,O.ETIMEDOUT))},s);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),e=null)};e.forEach(c=>c.addEventListener("abort",i));const{signal:h}=r;return h.unsubscribe=()=>f.asap(l),h}},Nn=function*(e,s){let n=e.byteLength;if(n<s){yield e;return}let r=0,a;for(;r<n;)a=r+s,yield e.slice(r,a),r=a},vn=async function*(e,s){for await(const n of _n(e))yield*Nn(n,s)},_n=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const s=e.getReader();try{for(;;){const{done:n,value:r}=await s.read();if(n)break;yield r}}finally{await s.cancel()}},Zt=(e,s,n,r)=>{const a=vn(e,s);let i=0,o,l=h=>{o||(o=!0,r&&r(h))};return new ReadableStream({async pull(h){try{const{done:c,value:d}=await a.next();if(c){l(),h.close();return}let g=d.byteLength;if(n){let j=i+=g;n(j)}h.enqueue(new Uint8Array(d))}catch(c){throw l(c),c}},cancel(h){return l(h),a.return()}},{highWaterMark:2})},Gt=64*1024,{isFunction:dt}=f,Sn=(({Request:e,Response:s})=>({Request:e,Response:s}))(f.global),{ReadableStream:Qt,TextEncoder:es}=f.global,ts=(e,...s)=>{try{return!!e(...s)}catch{return!1}},Ln=e=>{e=f.merge.call({skipUndefined:!0},Sn,e);const{fetch:s,Request:n,Response:r}=e,a=s?dt(s):typeof fetch=="function",i=dt(n),o=dt(r);if(!a)return!1;const l=a&&dt(Qt),h=a&&(typeof es=="function"?(m=>u=>m.encode(u))(new es):async m=>new Uint8Array(await new n(m).arrayBuffer())),c=i&&l&&ts(()=>{let m=!1;const u=new n(pe.origin,{body:new Qt,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!u}),d=o&&l&&ts(()=>f.isReadableStream(new r("").body)),g={stream:d&&(m=>m.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!g[m]&&(g[m]=(u,x)=>{let N=u&&u[m];if(N)return N.call(u);throw new O(`Response type '${m}' is not supported`,O.ERR_NOT_SUPPORT,x)})});const j=async m=>{if(m==null)return 0;if(f.isBlob(m))return m.size;if(f.isSpecCompliantForm(m))return(await new n(pe.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(f.isArrayBufferView(m)||f.isArrayBuffer(m))return m.byteLength;if(f.isURLSearchParams(m)&&(m=m+""),f.isString(m))return(await h(m)).byteLength},_=async(m,u)=>{const x=f.toFiniteNumber(m.getContentLength());return x??j(u)};return async m=>{let{url:u,method:x,data:N,signal:y,cancelToken:S,timeout:D,onDownloadProgress:Y,onUploadProgress:M,responseType:v,headers:C,withCredentials:b="same-origin",fetchOptions:U}=ks(m),Z=s||fetch;v=v?(v+"").toLowerCase():"text";let re=wn([y,S&&S.toAbortSignal()],D),B=null;const ee=re&&re.unsubscribe&&(()=>{re.unsubscribe()});let oe;try{if(M&&c&&x!=="get"&&x!=="head"&&(oe=await _(C,N))!==0){let le=new n(u,{method:"POST",body:N,duplex:"half"}),Ne;if(f.isFormData(N)&&(Ne=le.headers.get("content-type"))&&C.setContentType(Ne),le.body){const[Ae,ve]=Jt(oe,xt(Vt(M)));N=Zt(le.body,Gt,Ae,ve)}}f.isString(b)||(b=b?"include":"omit");const Q=i&&"credentials"in n.prototype,L={...U,signal:re,method:x.toUpperCase(),headers:C.normalize().toJSON(),body:N,duplex:"half",credentials:Q?b:void 0};B=i&&new n(u,L);let J=await(i?Z(B,U):Z(u,L));const $=d&&(v==="stream"||v==="response");if(d&&(Y||$&&ee)){const le={};["status","statusText","headers"].forEach(ne=>{le[ne]=J[ne]});const Ne=f.toFiniteNumber(J.headers.get("content-length")),[Ae,ve]=Y&&Jt(Ne,xt(Vt(Y),!0))||[];J=new r(Zt(J.body,Gt,Ae,()=>{ve&&ve(),ee&&ee()}),le)}v=v||"text";let xe=await g[f.findKey(g,v)||"text"](J,m);return!$&&ee&&ee(),await new Promise((le,Ne)=>{Rs(le,Ne,{data:xe,headers:we.from(J.headers),status:J.status,statusText:J.statusText,config:m,request:B})})}catch(Q){throw ee&&ee(),Q&&Q.name==="TypeError"&&/Load failed|fetch/i.test(Q.message)?Object.assign(new O("Network Error",O.ERR_NETWORK,m,B),{cause:Q.cause||Q}):O.from(Q,Q&&Q.code,m,B)}}},En=new Map,As=e=>{let s=e&&e.env||{};const{fetch:n,Request:r,Response:a}=s,i=[r,a,n];let o=i.length,l=o,h,c,d=En;for(;l--;)h=i[l],c=d.get(h),c===void 0&&d.set(h,c=l?new Map:Ln(s)),d=c;return c};As();const Dt={http:Wr,xhr:jn,fetch:{get:As}};f.forEach(Dt,(e,s)=>{if(e){try{Object.defineProperty(e,"name",{value:s})}catch{}Object.defineProperty(e,"adapterName",{value:s})}});const ss=e=>`- ${e}`,Rn=e=>f.isFunction(e)||e===null||e===!1;function $n(e,s){e=f.isArray(e)?e:[e];const{length:n}=e;let r,a;const i={};for(let o=0;o<n;o++){r=e[o];let l;if(a=r,!Rn(r)&&(a=Dt[(l=String(r)).toLowerCase()],a===void 0))throw new O(`Unknown adapter '${l}'`);if(a&&(f.isFunction(a)||(a=a.get(s))))break;i[l||"#"+o]=a}if(!a){const o=Object.entries(i).map(([h,c])=>`adapter ${h} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=n?o.length>1?`since :
`+o.map(ss).join(`
`):" "+ss(o[0]):"as no adapter specified";throw new O("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a}const Ts={getAdapter:$n,adapters:Dt};function St(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Je(null,e)}function rs(e){return St(e),e.headers=we.from(e.headers),e.data=_t.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ts.getAdapter(e.adapter||at.adapter,e)(e).then(function(r){return St(e),r.data=_t.call(e,e.transformResponse,r),r.headers=we.from(r.headers),r},function(r){return Es(r)||(St(e),r&&r.response&&(r.response.data=_t.call(e,e.transformResponse,r.response),r.response.headers=we.from(r.response.headers))),Promise.reject(r)})}const Os="1.13.2",Nt={};["object","boolean","number","function","string","symbol"].forEach((e,s)=>{Nt[e]=function(r){return typeof r===e||"a"+(s<1?"n ":" ")+e}});const ns={};Nt.transitional=function(s,n,r){function a(i,o){return"[Axios v"+Os+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(s===!1)throw new O(a(o," has been removed"+(n?" in "+n:"")),O.ERR_DEPRECATED);return n&&!ns[o]&&(ns[o]=!0,console.warn(a(o," has been deprecated since v"+n+" and will be removed in the near future"))),s?s(i,o,l):!0}};Nt.spelling=function(s){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${s}`),!0)};function kn(e,s,n){if(typeof e!="object")throw new O("options must be an object",O.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const i=r[a],o=s[i];if(o){const l=e[i],h=l===void 0||o(l,i,e);if(h!==!0)throw new O("option "+i+" must be "+h,O.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new O("Unknown option "+i,O.ERR_BAD_OPTION)}}const pt={assertOptions:kn,validators:Nt},Oe=pt.validators;let Be=class{constructor(s){this.defaults=s||{},this.interceptors={request:new Xt,response:new Xt}}async request(s,n){try{return await this._request(s,n)}catch(r){if(r instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(s,n){typeof s=="string"?(n=n||{},n.url=s):n=s||{},n=He(this.defaults,n);const{transitional:r,paramsSerializer:a,headers:i}=n;r!==void 0&&pt.assertOptions(r,{silentJSONParsing:Oe.transitional(Oe.boolean),forcedJSONParsing:Oe.transitional(Oe.boolean),clarifyTimeoutError:Oe.transitional(Oe.boolean)},!1),a!=null&&(f.isFunction(a)?n.paramsSerializer={serialize:a}:pt.assertOptions(a,{encode:Oe.function,serialize:Oe.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),pt.assertOptions(n,{baseUrl:Oe.spelling("baseURL"),withXsrfToken:Oe.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&f.merge(i.common,i[n.method]);i&&f.forEach(["delete","get","head","post","put","patch","common"],m=>{delete i[m]}),n.headers=we.concat(o,i);const l=[];let h=!0;this.interceptors.request.forEach(function(u){typeof u.runWhen=="function"&&u.runWhen(n)===!1||(h=h&&u.synchronous,l.unshift(u.fulfilled,u.rejected))});const c=[];this.interceptors.response.forEach(function(u){c.push(u.fulfilled,u.rejected)});let d,g=0,j;if(!h){const m=[rs.bind(this),void 0];for(m.unshift(...l),m.push(...c),j=m.length,d=Promise.resolve(n);g<j;)d=d.then(m[g++],m[g++]);return d}j=l.length;let _=n;for(;g<j;){const m=l[g++],u=l[g++];try{_=m(_)}catch(x){u.call(this,x);break}}try{d=rs.call(this,_)}catch(m){return Promise.reject(m)}for(g=0,j=c.length;g<j;)d=d.then(c[g++],c[g++]);return d}getUri(s){s=He(this.defaults,s);const n=$s(s.baseURL,s.url,s.allowAbsoluteUrls);return _s(n,s.params,s.paramsSerializer)}};f.forEach(["delete","get","head","options"],function(s){Be.prototype[s]=function(n,r){return this.request(He(r||{},{method:s,url:n,data:(r||{}).data}))}});f.forEach(["post","put","patch"],function(s){function n(r){return function(i,o,l){return this.request(He(l||{},{method:s,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Be.prototype[s]=n(),Be.prototype[s+"Form"]=n(!0)});let An=class Cs{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(a=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](a);r._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(a);return o.cancel=function(){r.unsubscribe(i)},o},s(function(i,o,l){r.reason||(r.reason=new Je(i,o,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const n=this._listeners.indexOf(s);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const s=new AbortController,n=r=>{s.abort(r)};return this.subscribe(n),s.signal.unsubscribe=()=>this.unsubscribe(n),s.signal}static source(){let s;return{token:new Cs(function(a){s=a}),cancel:s}}};function Tn(e){return function(n){return e.apply(null,n)}}function On(e){return f.isObject(e)&&e.isAxiosError===!0}const Ct={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Ct).forEach(([e,s])=>{Ct[s]=e});function Us(e){const s=new Be(e),n=hs(Be.prototype.request,s);return f.extend(n,Be.prototype,s,{allOwnKeys:!0}),f.extend(n,s,null,{allOwnKeys:!0}),n.create=function(a){return Us(He(e,a))},n}const se=Us(at);se.Axios=Be;se.CanceledError=Je;se.CancelToken=An;se.isCancel=Es;se.VERSION=Os;se.toFormData=wt;se.AxiosError=O;se.Cancel=se.CanceledError;se.all=function(s){return Promise.all(s)};se.spread=Tn;se.isAxiosError=On;se.mergeConfig=He;se.AxiosHeaders=we;se.formToJSON=e=>Ls(f.isHTMLForm(e)?new FormData(e):e);se.getAdapter=Ts.getAdapter;se.HttpStatusCode=Ct;se.default=se;const{Axios:ra,AxiosError:Cn,CanceledError:na,isCancel:aa,CancelToken:ia,VERSION:oa,all:la,Cancel:ca,isAxiosError:da,spread:ua,toFormData:ha,AxiosHeaders:ma,HttpStatusCode:fa,formToJSON:pa,getAdapter:xa,mergeConfig:ga}=se,Un="/api",X=se.create({baseURL:Un,headers:{"Content-Type":"application/json"}});X.interceptors.request.use(e=>{const s=localStorage.getItem("access_token");return s&&(e.headers.Authorization=`Bearer ${s}`),e});X.interceptors.response.use(e=>e,e=>Promise.reject(e));const Re={async login(e){const s=new FormData;return s.append("username",e.username),s.append("password",e.password),(await X.post("/auth/login",s,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data},async register(e){return(await X.post("/auth/register",e)).data},async getCurrentUser(){return(await X.get("/auth/me")).data},async listUsers(){return(await X.get("/auth/users")).data},async getStats(){return(await X.get("/auth/stats")).data},async updateUser(e,s){return(await X.put(`/auth/users/${e}`,s)).data},async heartbeat(){await X.post("/auth/heartbeat")}},ut={async list(){return(await X.get("/rooms/")).data},async get(e){return(await X.get(`/rooms/${e}`)).data},async create(e){return(await X.post("/rooms/",e)).data},async update(e,s){return(await X.put(`/rooms/${e}`,s)).data},async delete(e){await X.delete(`/rooms/${e}`)}},Lt={async list(e){const s=e?{room_id:e}:{};return(await X.get("/storage-units/",{params:s})).data},async get(e){return(await X.get(`/storage-units/${e}`)).data},async create(e){return(await X.post("/storage-units/",e)).data},async update(e,s){return(await X.put(`/storage-units/${e}`,s)).data},async delete(e){await X.delete(`/storage-units/${e}`)}},Et={async list(e){const s=e?{room_id:e}:{};return(await X.get("/blocks/",{params:s})).data},async get(e){return(await X.get(`/blocks/${e}`)).data},async create(e){return(await X.post("/blocks/",e)).data},async update(e,s){return(await X.put(`/blocks/${e}`,s)).data},async delete(e){await X.delete(`/blocks/${e}`)}},qe={async search(e){return(await X.get("/items/search",{params:e})).data},async list(e){return(await X.get("/items/",{params:e})).data},async get(e){return(await X.get(`/items/${e}`)).data},async create(e){return(await X.post("/items/",e)).data},async update(e,s){return(await X.put(`/items/${e}`,s)).data},async move(e,s){return(await X.post(`/items/${e}/move`,s)).data},async delete(e){await X.delete(`/items/${e}`)},async getHistory(e){return(await X.get(`/items/${e}/history`)).data}},as={viewer:0,editor:1,admin:2},Ce=cs()(rr((e,s)=>({user:null,token:null,isLoading:!1,error:null,login:async n=>{e({isLoading:!0,error:null});try{const r=await Re.login(n);localStorage.setItem("access_token",r.access_token),e({token:r.access_token});const a=await Re.getCurrentUser();return e({user:a,isLoading:!1}),!0}catch(r){const a=r instanceof Error?r.message:"Login failed";return e({error:a,isLoading:!1}),!1}},register:async n=>{var r,a;e({isLoading:!0,error:null});try{await Re.register(n);const i=await Re.login({username:n.username,password:n.password});localStorage.setItem("access_token",i.access_token),e({token:i.access_token});const o=await Re.getCurrentUser();return e({user:o,isLoading:!1}),!0}catch(i){let o="Registration failed";return i&&typeof i=="object"&&"response"in i&&(o=((a=(r=i.response)==null?void 0:r.data)==null?void 0:a.detail)||o),e({error:o,isLoading:!1}),!1}},logout:()=>{localStorage.removeItem("access_token"),e({user:null,token:null,error:null})},fetchUser:async()=>{const n=localStorage.getItem("access_token");if(!n){e({user:null,token:null,isLoading:!1});return}e({isLoading:!0});try{const r=await Re.getCurrentUser();e({user:r,token:n,isLoading:!1})}catch{localStorage.removeItem("access_token"),e({user:null,token:null,isLoading:!1})}},hasRole:n=>{const{user:r}=s();return r?as[r.role]>=as[n]:!1},canEdit:()=>s().hasRole("editor"),isAdmin:()=>s().hasRole("admin"),isAuthenticated:()=>{const{user:n,token:r}=s();return!!(n&&r)},clearError:()=>e({error:null})}),{name:"auth-storage",partialize:e=>({token:e.token,user:e.user}),onRehydrateStorage:()=>e=>{e!=null&&e.token&&!(e!=null&&e.user)&&Ce.setState({isLoading:!0})}})),Fn=[{path:"/",label:"Dashboard",icon:"ðŸ“Š"},{path:"/rooms",label:"Rooms",icon:"ðŸ "},{path:"/search",label:"Search",icon:"ðŸ”"}];function Pn(){const e=et(),s=tt(),{user:n,logout:r,isAdmin:a,token:i}=Ce();return E.useEffect(()=>{if(!i)return;const o=async()=>{try{await Re.heartbeat()}catch{}};o();const l=setInterval(o,2*60*1e3);return()=>clearInterval(l)},[i]),t.jsxs("div",{className:"min-h-screen flex bg-gray-100",children:[t.jsxs("aside",{className:"w-64 bg-white shadow-sm flex flex-col",children:[t.jsx("div",{className:"p-4 border-b",children:t.jsx("h1",{className:"text-xl font-bold text-primary-600",children:"Inventory Manager"})}),t.jsx("nav",{className:"p-4 flex-1",children:t.jsxs("ul",{className:"space-y-2",children:[Fn.map(o=>t.jsx("li",{children:t.jsxs($e,{to:o.path,className:`flex items-center gap-3 px-3 py-2 rounded-md transition-colors ${e.pathname===o.path?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-50"}`,children:[t.jsx("span",{children:o.icon}),t.jsx("span",{children:o.label})]})},o.path)),a()&&t.jsx("li",{children:t.jsxs($e,{to:"/admin",className:`flex items-center gap-3 px-3 py-2 rounded-md transition-colors ${e.pathname==="/admin"?"bg-primary-50 text-primary-700":"text-gray-700 hover:bg-gray-50"}`,children:[t.jsx("span",{children:"âš™ï¸"}),t.jsx("span",{children:"Admin Panel"})]})})]})}),t.jsx("div",{className:"p-4 border-t bg-white",children:n?t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:n.username}),t.jsx("p",{className:"text-xs text-gray-500 capitalize",children:n.role})]}),t.jsx("button",{onClick:()=>{r(),s("/")},className:"text-sm text-red-600 hover:text-red-800",children:"Logout"})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Viewing as guest"}),t.jsx("button",{onClick:()=>s("/login",{state:{from:e}}),className:"btn-primary text-sm w-full",children:"Sign in to edit"})]})})]}),t.jsx("main",{className:"flex-1 p-6 overflow-auto",children:t.jsx(Bs,{})})]})}function ht({children:e,requireAdmin:s=!1,redirectTo:n="/login"}){const{user:r,token:a,isLoading:i,isAdmin:o}=Ce(),l=et();return i?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):!a||!r?t.jsx($t,{to:n,state:{from:l},replace:!0}):s&&!o()?t.jsx($t,{to:"/",replace:!0}):t.jsx(t.Fragment,{children:e})}function Dn(){var Z,re;const e=tt(),s=et(),[n]=ls(),{login:r,register:a,isLoading:i,error:o,clearError:l,user:h,token:c}=Ce(),d=n.get("register")==="true",[g,j]=E.useState(d),[_,m]=E.useState(""),[u,x]=E.useState(""),[N,y]=E.useState(""),[S,D]=E.useState(""),[Y,M]=E.useState(""),v=((re=(Z=s.state)==null?void 0:Z.from)==null?void 0:re.pathname)||"/";E.useEffect(()=>{h&&c&&e(v,{replace:!0})},[h,c,e,v]);const C=async B=>{if(B.preventDefault(),l(),M(""),g){if(N!==S){M("Passwords do not match");return}if(N.length<8){M("Password must be at least 8 characters");return}await a({username:_,email:u,password:N})&&e(v,{replace:!0})}else await r({username:_,password:N})&&e(v,{replace:!0})},b=()=>{j(!g),l(),M(""),y(""),D("")},U=Y||o;return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:t.jsx("div",{className:"max-w-md w-full",children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Manager"}),t.jsx("p",{className:"text-gray-600 mt-2",children:g?"Create a new account":"Sign in to your account"})]}),U&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:U}),t.jsxs("form",{onSubmit:C,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"username",className:"label",children:"Username"}),t.jsx("input",{id:"username",type:"text",value:_,onChange:B=>m(B.target.value),className:"input",placeholder:"Enter your username",required:!0,autoFocus:!0})]}),g&&t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"label",children:"Email"}),t.jsx("input",{id:"email",type:"email",value:u,onChange:B=>x(B.target.value),className:"input",placeholder:"Enter your email",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"label",children:"Password"}),t.jsx("input",{id:"password",type:"password",value:N,onChange:B=>y(B.target.value),className:"input",placeholder:"Enter your password",required:!0})]}),g&&t.jsxs("div",{children:[t.jsx("label",{htmlFor:"confirmPassword",className:"label",children:"Confirm Password"}),t.jsx("input",{id:"confirmPassword",type:"password",value:S,onChange:B=>D(B.target.value),className:"input",placeholder:"Confirm your password",required:!0})]}),t.jsx("button",{type:"submit",disabled:i,className:"btn-primary w-full",children:i?g?"Creating account...":"Signing in...":g?"Create Account":"Sign in"})]}),t.jsxs("div",{className:"mt-6 text-center",children:[t.jsx("p",{className:"text-sm text-gray-500",children:g?t.jsxs(t.Fragment,{children:["Already have an account?"," ",t.jsx("button",{type:"button",onClick:b,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]}):t.jsxs(t.Fragment,{children:["Don't have an account?"," ",t.jsx("button",{type:"button",onClick:b,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Register"})]})}),!g&&t.jsx("p",{className:"mt-2 text-xs text-gray-400",children:"The first user to register will become an admin."})]})]})})})}function Ee(e,s){var n,r;return e instanceof Cn&&((r=(n=e.response)==null?void 0:n.data)!=null&&r.detail)?e.response.data.detail:e instanceof Error?e.message:s}const it=cs((e,s)=>({rooms:[],currentRoom:null,currentUnit:null,items:[],searchResults:[],searchTotal:0,isLoading:!1,error:null,selectedUnitId:null,fetchRooms:async()=>{e({isLoading:!0,error:null});try{const n=await ut.list();e({rooms:n,isLoading:!1})}catch(n){const r=n instanceof Error?n.message:"Failed to fetch rooms";e({error:r,isLoading:!1})}},fetchRoom:async n=>{e({isLoading:!0,error:null});try{const r=await ut.get(n);e({currentRoom:r,isLoading:!1})}catch(r){const a=r instanceof Error?r.message:"Failed to fetch room";e({error:a,isLoading:!1})}},createRoom:async n=>{e({isLoading:!0,error:null});try{const r=await ut.create(n);return e(a=>({rooms:[...a.rooms,r],isLoading:!1})),r}catch(r){const a=r instanceof Error?r.message:"Failed to create room";return e({error:a,isLoading:!1}),null}},deleteRoom:async n=>{e({isLoading:!0,error:null});try{return await ut.delete(n),e(r=>{var a;return{rooms:r.rooms.filter(i=>i.id!==n),currentRoom:((a=r.currentRoom)==null?void 0:a.id)===n?null:r.currentRoom,isLoading:!1}}),!0}catch(r){const a=Ee(r,"Failed to delete room");return e({error:a,isLoading:!1}),!1}},createUnit:async n=>{e({isLoading:!0,error:null});try{const r=await Lt.create(n),{currentRoom:a}=s();return a&&a.id===n.room_id&&await s().fetchRoom(a.id),e({isLoading:!1}),r}catch(r){const a=Ee(r,"Failed to create unit");return e({error:a,isLoading:!1}),null}},updateUnit:async(n,r)=>{e({isLoading:!0,error:null});try{const a=await Lt.update(n,r),{currentRoom:i}=s();return i&&await s().fetchRoom(i.id),e({isLoading:!1}),a}catch(a){const i=Ee(a,"Failed to update unit");return e({error:i,isLoading:!1}),null}},deleteUnit:async n=>{e({isLoading:!0,error:null});try{await Lt.delete(n);const{currentRoom:r}=s();return r&&await s().fetchRoom(r.id),e({selectedUnitId:null,items:[],isLoading:!1}),!0}catch(r){const a=Ee(r,"Failed to delete unit");return e({error:a,isLoading:!1}),!1}},selectUnit:n=>{e({selectedUnitId:n})},createBlock:async n=>{e({isLoading:!0,error:null});try{const r=await Et.create(n),{currentRoom:a}=s();return a&&a.id===n.room_id&&await s().fetchRoom(a.id),e({isLoading:!1}),r}catch(r){const a=Ee(r,"Failed to create block");return e({error:a,isLoading:!1}),null}},updateBlock:async(n,r)=>{e({isLoading:!0,error:null});try{const a=await Et.update(n,r),{currentRoom:i}=s();return i&&await s().fetchRoom(i.id),e({isLoading:!1}),a}catch(a){const i=Ee(a,"Failed to update block");return e({error:i,isLoading:!1}),null}},deleteBlock:async n=>{e({isLoading:!0,error:null});try{await Et.delete(n);const{currentRoom:r}=s();return r&&await s().fetchRoom(r.id),e({isLoading:!1}),!0}catch(r){const a=Ee(r,"Failed to delete block");return e({error:a,isLoading:!1}),!1}},fetchItems:async n=>{e({isLoading:!0,error:null});try{const r=await qe.list({storage_unit_id:n});e({items:r,isLoading:!1})}catch(r){const a=r instanceof Error?r.message:"Failed to fetch items";e({error:a,isLoading:!1})}},createItem:async n=>{e({isLoading:!0,error:null});try{const r=await qe.create(n);return e(a=>({items:[...a.items,r],isLoading:!1})),r}catch(r){const a=Ee(r,"Failed to create item");return e({error:a,isLoading:!1}),null}},updateItem:async(n,r)=>{e({isLoading:!0,error:null});try{const a=await qe.update(n,r);return e(i=>({items:i.items.map(o=>o.id===n?a:o),isLoading:!1})),a}catch(a){const i=Ee(a,"Failed to update item");return e({error:i,isLoading:!1}),null}},moveItem:async(n,r)=>{e({isLoading:!0,error:null});try{const a=await qe.move(n,r);return e(i=>({items:i.items.filter(o=>o.id!==n),isLoading:!1})),a}catch(a){const i=Ee(a,"Failed to move item");return e({error:i,isLoading:!1}),null}},deleteItem:async n=>{e({isLoading:!0,error:null});try{return await qe.delete(n),e(r=>({items:r.items.filter(a=>a.id!==n),isLoading:!1})),!0}catch(r){const a=Ee(r,"Failed to delete item");return e({error:a,isLoading:!1}),!1}},searchItems:async(n,r)=>{e({isLoading:!0,error:null});try{const a=await qe.search({query:n,...r,limit:50});e({searchResults:a.items,searchTotal:a.total,isLoading:!1})}catch(a){const i=a instanceof Error?a.message:"Search failed";e({error:i,isLoading:!1})}},clearSearch:()=>{e({searchResults:[],searchTotal:0})},clearError:()=>e({error:null})}));function Mt({isOpen:e,onClose:s,message:n}){const r=tt(),a=et();if(!e)return null;const i=()=>{s(),r("/login",{state:{from:a}})};return t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm mx-4 shadow-xl",children:[t.jsx("h2",{className:"text-xl font-bold mb-2",children:"Sign in required"}),t.jsx("p",{className:"text-gray-600 mb-6",children:n||"You need to sign in to make changes to the inventory."}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:s,className:"btn-secondary flex-1",children:"Cancel"}),t.jsx("button",{onClick:i,className:"btn-primary flex-1",children:"Sign in"})]})]})})}function Mn(){const{rooms:e,fetchRooms:s,isLoading:n}=it(),{user:r,canEdit:a,isAuthenticated:i}=Ce(),[o,l]=E.useState(!1),h=tt();et();const c=r&&!a(),d=g=>{i()?a()&&h(`/rooms/${g}`):l(!0)};return E.useEffect(()=>{s()},[]),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome, ",r==null?void 0:r.username]}),t.jsx("p",{className:"text-gray-600",children:"Here's an overview of your inventory"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx("div",{className:"card",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Total Rooms"}),t.jsx("p",{className:"text-2xl font-bold",children:e.length})]}),t.jsx("span",{className:"text-4xl",children:"ðŸ "})]})}),t.jsx("div",{className:"card",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Your Role"}),t.jsx("p",{className:"text-2xl font-bold capitalize",children:r==null?void 0:r.role})]}),t.jsx("span",{className:"text-4xl",children:"ðŸ‘¤"})]})}),t.jsx("div",{className:"card",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Quick Actions"}),a()?t.jsx($e,{to:"/search",className:"text-primary-600 hover:underline",children:"Search Items â†’"}):t.jsx($e,{to:"/rooms",className:"text-primary-600 hover:underline",children:"View Rooms â†’"})]}),t.jsx("span",{className:"text-4xl",children:a()?"ðŸ”":"ðŸ "})]})})]}),c&&t.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsx("h3",{className:"font-semibold text-yellow-800",children:"Limited Access"}),t.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"As a Viewer, you can only see the list of rooms. Contact an administrator to request Editor access to view items, storage units, and use search."})]}),t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Rooms"}),n?t.jsx("p",{className:"text-gray-500",children:"Loading..."}):e.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-gray-500 mb-4",children:"No rooms yet"}),t.jsx($e,{to:"/rooms",className:"btn-primary",children:"Create your first room"})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.slice(0,6).map(g=>t.jsxs("button",{onClick:()=>d(g.id),className:`p-4 border rounded-lg text-left transition-colors ${a()?"hover:border-primary-500 cursor-pointer":i()?"bg-gray-50 cursor-not-allowed":"hover:border-primary-500 cursor-pointer"}`,children:[t.jsx("h3",{className:"font-medium",children:g.name}),g.building&&t.jsx("p",{className:"text-sm text-gray-500",children:g.building})]},g.id))}),e.length>6&&t.jsx("div",{className:"mt-4 text-center",children:t.jsxs($e,{to:"/rooms",className:"text-primary-600 hover:underline",children:["View all ",e.length," rooms â†’"]})})]}),t.jsx(Mt,{isOpen:o,onClose:()=>l(!1),message:"You need to sign in to view room details."})]})}function In(e){const{orientation:s,verticalLegWidth:n,verticalLegHeight:r,horizontalLegWidth:a,horizontalLegHeight:i}=e,o=Math.max(n,a),l=r+i;let h,c;return h=o-n,c=l-i,h=Math.max(0,h),c=Math.max(0,c),{width:o,height:l,cutoutWidth:h,cutoutHeight:c}}function Bn(e,s,n,r,a){const i=n||e*.4,o=r||s*.4;return{orientation:a,verticalLegWidth:e-i,verticalLegHeight:o,horizontalLegWidth:e,horizontalLegHeight:s-o}}function Hn({orientation:e,selected:s,onClick:n}){const o=()=>{const d=23.400000000000002,g=52*.45;switch(e){case"top_right":return`M 0 0 L ${52-d} 0 L ${52-d} ${g} L 52 ${g} L 52 52 L 0 52 Z`;case"top_left":return`M ${d} 0 L 52 0 L 52 52 L 0 52 L 0 ${g} L ${d} ${g} Z`;case"bottom_right":return`M 0 0 L 52 0 L 52 ${52-g} L ${52-d} ${52-g} L ${52-d} 52 L 0 52 Z`;case"bottom_left":return`M 0 0 L 52 0 L 52 52 L ${d} 52 L ${d} ${52-g} L 0 ${52-g} Z`;default:return""}},l={top_right:"Top Right",top_left:"Top Left",bottom_right:"Bottom Right",bottom_left:"Bottom Left"};return t.jsxs("button",{type:"button",onClick:n,className:`flex flex-col items-center p-2 rounded-lg border-2 transition-all ${s?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[t.jsx("svg",{width:60,height:60,className:"mb-1",children:t.jsx("g",{transform:"translate(4, 4)",children:t.jsx("path",{d:o(),fill:s?"#3b82f6":"#9ca3af",stroke:s?"#1d4ed8":"#6b7280",strokeWidth:"1"})})}),t.jsx("span",{className:`text-xs ${s?"text-primary-700 font-medium":"text-gray-500"}`,children:l[e]})]})}function Wn({config:e}){const{orientation:s,verticalLegWidth:n,verticalLegHeight:r,horizontalLegWidth:a,horizontalLegHeight:i}=e,o=Math.max(n,a),l=r+i,h=180/Math.max(o,l),c=o*h,d=l*h,g=()=>{const _=c,m=d,u=n*h,x=r*h,N=a*h;switch(s){case"top_right":return`M 0 0 L ${u} 0 L ${u} ${x} L ${N} ${x} L ${N} ${m} L 0 ${m} Z`;case"top_left":return`M ${_-u} 0 L ${_} 0 L ${_} ${m} L 0 ${m} L 0 ${x} L ${_-u} ${x} Z`;case"bottom_right":return`M 0 0 L ${N} 0 L ${N} ${m-x} L ${u} ${m-x} L ${u} ${m} L 0 ${m} Z`;case"bottom_left":return`M 0 0 L ${_} 0 L ${_} ${m-x} L ${_-u} ${m-x} L ${_-u} ${m} L 0 ${m} Z`;default:return`M 0 0 L ${_} 0 L ${_} ${m} L 0 ${m} Z`}},j=o*l-(o-n)*(l-i);return t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("svg",{width:c+60,height:d+60,className:"bg-gray-50 rounded border",children:t.jsxs("g",{transform:"translate(30, 30)",children:[t.jsx("defs",{children:t.jsx("pattern",{id:"grid",width:h,height:h,patternUnits:"userSpaceOnUse",children:t.jsx("path",{d:`M ${h} 0 L 0 0 0 ${h}`,fill:"none",stroke:"#e5e7eb",strokeWidth:"0.5"})})}),t.jsx("rect",{width:c,height:d,fill:"url(#grid)",opacity:"0.5"}),t.jsx("path",{d:g(),fill:"#dbeafe",stroke:"#3b82f6",strokeWidth:"2"}),t.jsxs("text",{x:c/2,y:-8,textAnchor:"middle",className:"text-xs fill-gray-600",children:[o.toFixed(1),"m"]}),t.jsxs("text",{x:c+8,y:d/2,textAnchor:"start",dominantBaseline:"middle",className:"text-xs fill-gray-600",children:[l.toFixed(1),"m"]})]})}),t.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Total area: ~",j.toFixed(1)," mÂ²"]})]})}function zn({totalWidth:e,totalHeight:s,cutoutCorner:n,cutoutWidth:r,cutoutHeight:a,onChange:i}){const[o,l]=E.useState(()=>Bn(e||10,s||10,r,a,n||"bottom_right"));E.useEffect(()=>{const c=In(o);i({width:c.width,height:c.height,shape_cutout_corner:o.orientation,shape_cutout_width:c.cutoutWidth,shape_cutout_height:c.cutoutHeight})},[o]);const h=c=>{l(d=>({...d,...c}))};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"label mb-2",children:"Choose L-Shape Orientation"}),t.jsx("p",{className:"text-xs text-gray-500 mb-3",children:'Click to select which corner has the "notch"'}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:["top_left","top_right","bottom_left","bottom_right"].map(c=>t.jsx(Hn,{orientation:c,selected:o.orientation===c,onClick:()=>h({orientation:c})},c))})]}),t.jsxs("div",{className:"py-4",children:[t.jsx("label",{className:"label mb-2",children:"Preview"}),t.jsx(Wn,{config:o})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[t.jsx("label",{className:"label text-blue-800 mb-2",children:"Vertical Section"}),t.jsx("p",{className:"text-xs text-blue-600 mb-2",children:"The part that extends vertically"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-600",children:"Width (m)"}),t.jsx("input",{type:"number",value:o.verticalLegWidth,onChange:c=>h({verticalLegWidth:Math.max(1,Number(c.target.value))}),className:"input mt-1",min:"1",step:"0.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-600",children:"Height (m)"}),t.jsx("input",{type:"number",value:o.verticalLegHeight,onChange:c=>h({verticalLegHeight:Math.max(1,Number(c.target.value))}),className:"input mt-1",min:"1",step:"0.5"})]})]})]}),t.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[t.jsx("label",{className:"label text-green-800 mb-2",children:"Horizontal Section"}),t.jsx("p",{className:"text-xs text-green-600 mb-2",children:"The part that extends horizontally"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-600",children:"Width (m)"}),t.jsx("input",{type:"number",value:o.horizontalLegWidth,onChange:c=>h({horizontalLegWidth:Math.max(1,Number(c.target.value))}),className:"input mt-1",min:"1",step:"0.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-600",children:"Height (m)"}),t.jsx("input",{type:"number",value:o.horizontalLegHeight,onChange:c=>h({horizontalLegHeight:Math.max(1,Number(c.target.value))}),className:"input mt-1",min:"1",step:"0.5"})]})]})]})]}),t.jsx("p",{className:"text-xs text-gray-400 italic",children:"Tip: The two sections share a common edge where they meet."})]})}function qn(){const{rooms:e,fetchRooms:s,createRoom:n,deleteRoom:r,isLoading:a,error:i}=it(),{canEdit:o,isAdmin:l,isAuthenticated:h}=Ce(),c=tt(),[d,g]=E.useState(!1),[j,_]=E.useState(""),[m,u]=E.useState(!1),[x,N]=E.useState(!1),[y,S]=E.useState({name:"",building:"",width:10,height:10,notes:"",shape:"rectangle",door_wall:"north",door_position:.5,door_width:1});E.useEffect(()=>{s()},[]);const D=async v=>{v.preventDefault(),await n(y)&&(u(!1),N(!1),S({name:"",building:"",width:10,height:10,notes:"",shape:"rectangle",door_wall:"north",door_position:.5,door_width:1}))},Y=async(v,C)=>{confirm(`Are you sure you want to delete "${C}"? This will delete all storage units and items in this room.`)&&await r(v)},M=v=>{h()?o()&&c(`/rooms/${v}`):(_("You need to sign in to view room details."),g(!0))};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Rooms"}),t.jsx("p",{className:"text-gray-600",children:"Manage your physical locations"})]}),o()&&t.jsx("button",{onClick:()=>{h()?u(!0):(_("You need to sign in to create rooms."),g(!0))},className:"btn-primary",children:"+ Create Room"})]}),i&&t.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-700",children:i}),a?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),t.jsx("p",{className:"mt-2 text-gray-500",children:"Loading rooms..."})]}):e.length===0?t.jsxs("div",{className:"card text-center py-12",children:[t.jsx("p",{className:"text-gray-500 mb-4",children:"No rooms yet"}),o()&&t.jsx("button",{onClick:()=>u(!0),className:"btn-primary",children:"Create your first room"})]}):t.jsx("div",{className:"space-y-6",children:(()=>{const v=e.reduce((b,U)=>{const Z=U.building||"No Building";return b[Z]||(b[Z]=[]),b[Z].push(U),b},{});return Object.keys(v).sort((b,U)=>b==="No Building"?1:U==="No Building"?-1:b.localeCompare(U)).map(b=>t.jsxs("div",{children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-700 mb-3 border-b border-gray-200 pb-2",children:[b,t.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",v[b].length," room",v[b].length!==1?"s":"",")"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v[b].map(U=>t.jsxs("div",{className:`card transition-shadow ${o()||!h()?"hover:shadow-md cursor-pointer":""}`,onClick:()=>M(U.id),children:[t.jsx("h3",{className:"font-semibold text-lg",children:U.name}),U.width&&U.height&&t.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[U.width,"m Ã— ",U.height,"m"]}),l()&&t.jsx("button",{onClick:Z=>{Z.stopPropagation(),Y(U.id,U.name)},className:"mt-4 text-sm text-red-600 hover:text-red-800",children:"Delete"})]},U.id))})]},b))})()}),m&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Create Room"}),t.jsxs("form",{onSubmit:D,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"name",className:"label",children:"Name *"}),t.jsx("input",{id:"name",type:"text",value:y.name,onChange:v=>S({...y,name:v.target.value}),className:"input",required:!0,autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"building",className:"label",children:"Building"}),t.jsx("input",{id:"building",type:"text",value:y.building,onChange:v=>S({...y,building:v.target.value}),className:"input"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"width",className:"label",children:"Width (m)"}),t.jsx("input",{id:"width",type:"number",value:y.width,onChange:v=>S({...y,width:Number(v.target.value)}),className:"input",min:"1"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"height",className:"label",children:"Height (m)"}),t.jsx("input",{id:"height",type:"number",value:y.height,onChange:v=>S({...y,height:Number(v.target.value)}),className:"input",min:"1"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"notes",className:"label",children:"Notes"}),t.jsx("textarea",{id:"notes",value:y.notes,onChange:v=>S({...y,notes:v.target.value}),className:"input",rows:3})]}),t.jsxs("button",{type:"button",onClick:()=>N(!x),className:"text-sm text-primary-600 hover:text-primary-800 flex items-center gap-1",children:[x?"â–¼":"â–¶"," Advanced Options (Shape & Door)"]}),x&&t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-4 bg-gray-50",children:[t.jsxs("div",{children:[t.jsx("label",{className:"label mb-2",children:"Room Shape"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{type:"button",onClick:()=>S({...y,shape:"rectangle",shape_cutout_width:void 0,shape_cutout_height:void 0,shape_cutout_corner:void 0}),className:`flex flex-col items-center p-3 rounded-lg border-2 transition-all ${y.shape!=="l_shape"?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[t.jsx("svg",{width:"50",height:"50",className:"mb-1",children:t.jsx("rect",{x:"5",y:"5",width:"40",height:"40",fill:y.shape!=="l_shape"?"#3b82f6":"#9ca3af",stroke:y.shape!=="l_shape"?"#1d4ed8":"#6b7280",strokeWidth:"1"})}),t.jsx("span",{className:`text-xs ${y.shape!=="l_shape"?"text-primary-700 font-medium":"text-gray-500"}`,children:"Rectangle"})]}),t.jsxs("button",{type:"button",onClick:()=>S({...y,shape:"l_shape",shape_cutout_corner:y.shape_cutout_corner||"bottom_right",shape_cutout_width:y.shape_cutout_width||Math.floor((y.width||10)*.4),shape_cutout_height:y.shape_cutout_height||Math.floor((y.height||10)*.4)}),className:`flex flex-col items-center p-3 rounded-lg border-2 transition-all ${y.shape==="l_shape"?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[t.jsx("svg",{width:"50",height:"50",className:"mb-1",children:t.jsx("path",{d:"M 5 5 L 30 5 L 30 25 L 45 25 L 45 45 L 5 45 Z",fill:y.shape==="l_shape"?"#3b82f6":"#9ca3af",stroke:y.shape==="l_shape"?"#1d4ed8":"#6b7280",strokeWidth:"1"})}),t.jsx("span",{className:`text-xs ${y.shape==="l_shape"?"text-primary-700 font-medium":"text-gray-500"}`,children:"L-Shape"})]})]})]}),y.shape==="l_shape"&&t.jsx(zn,{totalWidth:y.width||10,totalHeight:y.height||10,cutoutCorner:y.shape_cutout_corner||null,cutoutWidth:y.shape_cutout_width||null,cutoutHeight:y.shape_cutout_height||null,onChange:v=>S({...y,width:v.width,height:v.height,shape_cutout_corner:v.shape_cutout_corner,shape_cutout_width:v.shape_cutout_width,shape_cutout_height:v.shape_cutout_height})}),t.jsxs("div",{className:"pt-2 border-t border-gray-200 space-y-3",children:[t.jsx("label",{className:"label",children:"Door Configuration"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Every room has a door. You can drag it along walls after creation."}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"doorWall",className:"text-xs text-gray-600",children:"Wall"}),t.jsxs("select",{id:"doorWall",value:y.door_wall||"north",onChange:v=>S({...y,door_wall:v.target.value}),className:"input mt-1",children:[t.jsx("option",{value:"north",children:"North Wall (Top)"}),t.jsx("option",{value:"south",children:"South Wall (Bottom)"}),t.jsx("option",{value:"east",children:"East Wall (Right)"}),t.jsx("option",{value:"west",children:"West Wall (Left)"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"doorPosition",className:"text-xs text-gray-600",children:"Position along wall"}),t.jsx("input",{id:"doorPosition",type:"range",min:"0.1",max:"0.9",step:"0.05",value:y.door_position||.5,onChange:v=>S({...y,door_position:Number(v.target.value)}),className:"w-full mt-1"}),t.jsxs("p",{className:"text-xs text-gray-500 text-center",children:[Math.round((y.door_position||.5)*100),"%"]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"doorWidth",className:"text-xs text-gray-600",children:"Door Width (m)"}),t.jsx("input",{id:"doorWidth",type:"number",value:y.door_width||1,onChange:v=>S({...y,door_width:Number(v.target.value)}),className:"input mt-1",min:"0.5",max:"3",step:"0.1"})]})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{type:"button",onClick:()=>{u(!1),N(!1)},className:"btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn-primary",children:"Create"})]})]})]})}),t.jsx(Mt,{isOpen:d,onClose:()=>g(!1),message:j||"You need to sign in to create rooms."})]})}function is({width:e,height:s,scale:n,onHandleMouseDown:r}){const i=e*n,o=s*n;return t.jsx("rect",{x:i-10/2,y:o-10/2,width:10,height:10,fill:"#ffffff",stroke:"#1d4ed8",strokeWidth:2,rx:2,style:{cursor:"nwse-resize"},onMouseDown:l=>r("se",l)})}const os={cabinet:"#3b82f6",desk:"#10b981",shelf:"#f59e0b",drawer:"#8b5cf6",box:"#ef4444",other:"#6b7280"};function Pe(e,s,n,r,a,i,o,l){return e<a+o-.01&&e+n>a+.01&&s<i+l-.01&&s+r>i+.01}function Rt(e,s,n,r,a,i,o="rectangle",l,h,c){if(e<0||s<0||e+n>a||s+r>i)return!1;if(o==="rectangle"||!l||!h||!c)return!0;const d=l,g=h;let j=0,_=0,m=0,u=0;switch(c){case"top_right":j=a-d,_=0,m=a,u=g;break;case"top_left":j=0,_=0,m=d,u=g;break;case"bottom_right":j=a-d,_=i-g,m=a,u=i;break;case"bottom_left":j=0,_=i-g,m=d,u=i;break}return!(e<m&&e+n>j&&s<u&&s+r>_)}function Xn(e,s,n,r="rectangle",a,i,o){const l=e*n,h=s*n;if(r==="rectangle"||!a||!i)return`M 0 0 L ${l} 0 L ${l} ${h} L 0 ${h} Z`;const c=a*n,d=i*n;switch(o){case"top_right":return`M 0 0 L ${l-c} 0 L ${l-c} ${d} L ${l} ${d} L ${l} ${h} L 0 ${h} Z`;case"top_left":return`M ${c} 0 L ${l} 0 L ${l} ${h} L 0 ${h} L 0 ${d} L ${c} ${d} Z`;case"bottom_right":return`M 0 0 L ${l} 0 L ${l} ${h-d} L ${l-c} ${h-d} L ${l-c} ${h} L 0 ${h} Z`;case"bottom_left":return`M 0 0 L ${l} 0 L ${l} ${h} L ${c} ${h} L ${c} ${h-d} L 0 ${h-d} Z`;default:return`M 0 0 L ${l-c} 0 L ${l-c} ${d} L ${l} ${d} L ${l} ${h} L 0 ${h} Z`}}function Yn({wall:e,position:s,doorWidth:n,roomWidth:r,roomHeight:a,scale:i,canMove:o,isDragging:l,onDragStart:h,shape:c,cutoutWidth:d,cutoutHeight:g,cutoutCorner:j}){const[_,m]=E.useState(!1),u=n*i,x=r*i,N=a*i,y=4,S=(d||0)*i,D=(g||0)*i,Y=c==="l_shape"&&d&&g&&j,M=_||l?"#3b82f6":"#374151",v=_||l?"#60a5fa":"#6b7280";let C=0,b=0,U=0,Z=0,re="",B=0,ee=0,oe=0,Q=0,L=0,J=0;switch(e){case"north":{Y&&(j==="top_left"||j==="top_right")?(L=x-S,J=j==="top_left"?S:0):(L=x,J=0),C=J+s*L-u/2,b=0,U=C,Z=u,re=`M ${C+u} 0 A ${u} ${u} 0 0 1 ${C} ${u}`,B=C,ee=-y,oe=u,Q=y*2;break}case"south":{Y&&(j==="bottom_left"||j==="bottom_right")?(L=x-S,J=j==="bottom_left"?S:0):(L=x,J=0),C=J+s*L-u/2,b=N,U=C,Z=N-u,re=`M ${C+u} ${N} A ${u} ${u} 0 0 0 ${C} ${N-u}`,B=C,ee=N-y,oe=u,Q=y*2;break}case"east":{Y&&(j==="top_right"||j==="bottom_right")?(L=N-D,J=j==="top_right"?D:0):(L=N,J=0),C=x,b=J+s*L-u/2,U=x-u,Z=b,re=`M ${U} ${Z} A ${u} ${u} 0 0 0 ${x} ${b+u}`,B=x-y,ee=b,oe=y*2,Q=u;break}case"west":{Y&&(j==="top_left"||j==="bottom_left")?(L=N-D,J=j==="top_left"?D:0):(L=N,J=0),C=0,b=J+s*L-u/2,U=u,Z=b,re=`M ${U} ${Z} A ${u} ${u} 0 0 1 0 ${b+u}`,B=-y,ee=b,oe=y*2,Q=u;break}case"cutout_horizontal":{if(!Y)break;L=S;const $=j==="top_left"||j==="top_right"?D:N-D,xe=j==="top_left"||j==="bottom_left"?0:x-S,le=j==="top_left"||j==="top_right";C=xe+s*L-u/2,b=$,U=C,Z=le?$+u:$-u,re=le?`M ${C+u} ${$} A ${u} ${u} 0 0 1 ${C} ${$+u}`:`M ${C+u} ${$} A ${u} ${u} 0 0 0 ${C} ${$-u}`,B=C,ee=$-y,oe=u,Q=y*2;break}case"cutout_vertical":{if(!Y)break;L=D;const $=j==="top_left"||j==="bottom_left"?S:x-S,xe=j==="top_left"||j==="top_right"?0:N-D,le=j==="top_left"||j==="bottom_left";C=$,b=xe+s*L-u/2,U=le?$+u:$-u,Z=b,re=le?`M ${$} ${b+u} A ${u} ${u} 0 0 0 ${$+u} ${b}`:`M ${$} ${b+u} A ${u} ${u} 0 0 1 ${$-u} ${b}`,B=$-y,ee=b,oe=y*2,Q=u;break}}return t.jsxs("g",{className:"door",style:{cursor:o?"ew-resize":"default"},onMouseDown:o?h:void 0,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),children:[t.jsx("rect",{x:B-8,y:ee-8,width:oe+16,height:Q+16,fill:"transparent"}),t.jsx("rect",{x:B,y:ee,width:oe,height:Q,fill:"#ffffff",stroke:"none"}),t.jsx("path",{d:re,fill:"none",stroke:v,strokeWidth:"1"}),t.jsx("line",{x1:C,y1:b,x2:U,y2:Z,stroke:M,strokeWidth:"2",strokeLinecap:"round"}),t.jsx("circle",{cx:C,cy:b,r:"3",fill:M})]})}function Jn({width:e,height:s,units:n,blocks:r=[],selectedBlockId:a,onBlockSelect:i,shape:o="rectangle",shapeCutoutWidth:l,shapeCutoutHeight:h,shapeCutoutCorner:c,doorWall:d,doorPosition:g,doorWidth:j=1,onUnitMove:_,onUnitMoveEnd:m,onUnitResize:u,onBlockMove:x,onBlockMoveEnd:N,onBlockResize:y,onDoorMove:S,onDoorMoveEnd:D}){const{selectedUnitId:Y,selectUnit:M}=it(),{canEdit:v}=Ce(),C=E.useRef(null),[b,U]=E.useState(null),[Z,re]=E.useState({x:0,y:0}),[B,ee]=E.useState(null),[oe,Q]=E.useState(null),[L,J]=E.useState(null),[$,xe]=E.useState(null),[le,Ne]=E.useState(!1),Ae=800,ve=600,ne=e||10,me=s||10,_e=Ae/ne,De=ve/me,k=Math.min(_e,De)*.85,Se=(Ae-ne*k)/2,ye=(ve-me*k)/2,We=(w,V)=>{V.stopPropagation(),M(w===Y?null:w),i&&i(null)},ce=(w,V)=>{V.stopPropagation(),i&&i(w===a?null:w),M(null)},Te=(w,V)=>{var R;if(!v()||!_&&!m)return;const q=C.current;if(!q)return;const H=q.createSVGPoint();H.x=V.clientX,H.y=V.clientY;const K=H.matrixTransform((R=q.getScreenCTM())==null?void 0:R.inverse());U({type:"unit",id:w.id}),re({x:K.x-Se-w.x*k,y:K.y-ye-w.y*k}),xe({id:w.id,x:w.x,y:w.y})},ot=(w,V)=>{var R;if(!v()||!x&&!N)return;const q=C.current;if(!q)return;const H=q.createSVGPoint();H.x=V.clientX,H.y=V.clientY;const K=H.matrixTransform((R=q.getScreenCTM())==null?void 0:R.inverse());U({type:"block",id:w.id}),re({x:K.x-Se-w.x*k,y:K.y-ye-w.y*k}),xe({id:w.id,x:w.x,y:w.y})},lt=w=>{!v()||!D||(w.stopPropagation(),U({type:"door"}))},Le=(w,V,q)=>{var W;if(!v()||!u)return;q.stopPropagation();const H=C.current;if(!H)return;const K=H.createSVGPoint();K.x=q.clientX,K.y=q.clientY;const R=K.matrixTransform((W=H.getScreenCTM())==null?void 0:W.inverse());U({type:"resize-unit",id:w.id,handle:V,startX:R.x,startY:R.y,startWidth:w.width,startHeight:w.height}),J({id:w.id,width:w.width,height:w.height})},Ve=(w,V,q)=>{var W;if(!v()||!y)return;q.stopPropagation();const H=C.current;if(!H)return;const K=H.createSVGPoint();K.x=q.clientX,K.y=q.clientY;const R=K.matrixTransform((W=H.getScreenCTM())==null?void 0:W.inverse());U({type:"resize-block",id:w.id,handle:V,startX:R.x,startY:R.y,startWidth:w.width,startHeight:w.height}),J({id:w.id,width:w.width,height:w.height})},ze=w=>{var K;if(!b)return;const V=C.current;if(!V)return;const q=V.createSVGPoint();q.x=w.clientX,q.y=w.clientY;const H=q.matrixTransform((K=V.getScreenCTM())==null?void 0:K.inverse());if(b.type==="door"){const R=H.x-Se,W=H.y-ye,te=ne*k,G=me*k,z=(l||0)*k,I=(h||0)*k,F=o==="l_shape"&&l&&h&&c,de=W,ue=G-W,ie=R,ge=te-R;let T=1/0,p=1/0;if(F){const ct=c==="top_left"||c==="top_right"?I:G-I,Ze=c==="top_left"||c==="bottom_left"?0:te-z,Ps=Ze+z;R>=Ze&&R<=Ps&&(T=Math.abs(W-ct));const Ds=c==="top_left"||c==="bottom_left"?z:te-z,Bt=c==="top_left"||c==="top_right"?0:G-I,Ms=Bt+I;W>=Bt&&W<=Ms&&(p=Math.abs(R-Ds))}let be=[{wall:"north",dist:de},{wall:"south",dist:ue},{wall:"west",dist:ie},{wall:"east",dist:ge},{wall:"cutout_horizontal",dist:T},{wall:"cutout_vertical",dist:p}].reduce((ct,Ze)=>Ze.dist<ct.dist?Ze:ct).wall,ae=0,he=0,fe=0;switch(be){case"north":F&&(c==="top_left"||c==="top_right")?(he=te-z,fe=c==="top_left"?z:0):(he=te,fe=0),ae=(R-fe)/he;break;case"south":F&&(c==="bottom_left"||c==="bottom_right")?(he=te-z,fe=c==="bottom_left"?z:0):(he=te,fe=0),ae=(R-fe)/he;break;case"west":F&&(c==="top_left"||c==="bottom_left")?(he=G-I,fe=c==="top_left"?I:0):(he=G,fe=0),ae=(W-fe)/he;break;case"east":F&&(c==="top_right"||c==="bottom_right")?(he=G-I,fe=c==="top_right"?I:0):(he=G,fe=0),ae=(W-fe)/he;break;case"cutout_horizontal":he=z,fe=c==="top_left"||c==="bottom_left"?0:te-z,ae=(R-fe)/he;break;case"cutout_vertical":he=I,fe=c==="top_left"||c==="top_right"?0:G-I,ae=(W-fe)/he;break}const Fs=he/k,It=(j||1)/Fs;ae=Math.max(It/2+.02,Math.min(1-It/2-.02,ae)),ee(be),Q(ae),S&&S(be,ae)}else if(b.type==="unit"&&b.id){const R=n.find(W=>W.id===b.id);if(R){const W=($==null?void 0:$.x)??R.x,te=($==null?void 0:$.y)??R.y,G=(H.x-Se-Z.x)/k,z=(H.y-ye-Z.y)/k,I=Math.max(0,Math.min(ne-R.width,G)),F=Math.max(0,Math.min(me-R.height,z)),de=(ge,T)=>{if(!Rt(ge,T,R.width,R.height,ne,me,o,l,h,c))return!1;const p=n.some(A=>A.id!==R.id&&Pe(ge,T,R.width,R.height,A.x,A.y,A.width,A.height)),P=r.some(A=>Pe(ge,T,R.width,R.height,A.x,A.y,A.width,A.height));return!p&&!P};let ue=W,ie=te;de(I,F)?(ue=I,ie=F):(de(I,te)&&(ue=I),de(W,F)&&(ie=F)),(ue!==W||ie!==te)&&(xe({id:b.id,x:ue,y:ie}),_&&_(b.id,ue,ie))}}else if(b.type==="block"&&b.id){const R=r.find(W=>W.id===b.id);if(R){const W=($==null?void 0:$.x)??R.x,te=($==null?void 0:$.y)??R.y,G=(H.x-Se-Z.x)/k,z=(H.y-ye-Z.y)/k,I=Math.max(0,Math.min(ne-R.width,G)),F=Math.max(0,Math.min(me-R.height,z)),de=(ge,T)=>{if(!Rt(ge,T,R.width,R.height,ne,me,o,l,h,c))return!1;const p=r.some(A=>A.id!==R.id&&Pe(ge,T,R.width,R.height,A.x,A.y,A.width,A.height)),P=n.some(A=>Pe(ge,T,R.width,R.height,A.x,A.y,A.width,A.height));return!p&&!P};let ue=W,ie=te;de(I,F)?(ue=I,ie=F):(de(I,te)&&(ue=I),de(W,F)&&(ie=F)),(ue!==W||ie!==te)&&(xe({id:b.id,x:ue,y:ie}),x&&x(b.id,ue,ie))}}else if((b.type==="resize-unit"||b.type==="resize-block")&&b.id&&b.handle){const R=(H.x-(b.startX||0))/k,W=(H.y-(b.startY||0))/k,te=b.startWidth||1,G=b.startHeight||1;let z=Math.max(.5,te+R),I=Math.max(.5,G+W);z=Math.round(z*10)/10,I=Math.round(I*10)/10;const F=b.type==="resize-unit"?n.find(de=>de.id===b.id):r.find(de=>de.id===b.id);if(F){const de=ne-F.x,ue=me-F.y;if(z=Math.min(z,de),I=Math.min(I,ue),Rt(F.x,F.y,z,I,ne,me,o,l,h,c)||(z=(L==null?void 0:L.width)||F.width,I=(L==null?void 0:L.height)||F.height),b.type==="resize-unit"){const ie=n.some(T=>T.id!==F.id&&Pe(F.x,F.y,z,I,T.x,T.y,T.width,T.height)),ge=r.some(T=>Pe(F.x,F.y,z,I,T.x,T.y,T.width,T.height));(ie||ge)&&(z=(L==null?void 0:L.width)||F.width,I=(L==null?void 0:L.height)||F.height)}else{const ie=r.some(T=>T.id!==F.id&&Pe(F.x,F.y,z,I,T.x,T.y,T.width,T.height)),ge=n.some(T=>Pe(F.x,F.y,z,I,T.x,T.y,T.width,T.height));(ie||ge)&&(z=(L==null?void 0:L.width)||F.width,I=(L==null?void 0:L.height)||F.height)}}J({id:b.id,width:z,height:I})}},Me=()=>{if(b&&(Ne(!0),setTimeout(()=>Ne(!1),50)),(b==null?void 0:b.type)==="door"&&oe!==null&&D){const w=B||d;w&&D(w,oe)}(b==null?void 0:b.type)==="unit"&&b.id&&$&&m&&m(b.id,$.x,$.y),(b==null?void 0:b.type)==="block"&&b.id&&$&&N&&N(b.id,$.x,$.y),(b==null?void 0:b.type)==="resize-unit"&&b.id&&L&&u&&u(b.id,L.width,L.height),(b==null?void 0:b.type)==="resize-block"&&b.id&&L&&y&&y(b.id,L.width,L.height),U(null),ee(null),Q(null),J(null),xe(null)},Ke=()=>{le||(M(null),i&&i(null))},Ue=Xn(ne,me,k,o,l,h,c);return t.jsxs("svg",{ref:C,viewBox:`0 0 ${Ae} ${ve}`,className:"room-canvas w-full h-auto",onClick:Ke,onMouseMove:ze,onMouseUp:Me,onMouseLeave:Me,children:[t.jsxs("defs",{children:[t.jsx("pattern",{id:"grid",width:k,height:k,patternUnits:"userSpaceOnUse",children:t.jsx("path",{d:`M ${k} 0 L 0 0 0 ${k}`,fill:"none",stroke:"#e5e7eb",strokeWidth:"0.5"})}),t.jsx("clipPath",{id:"roomClip",children:t.jsx("path",{d:Ue})})]}),t.jsxs("g",{transform:`translate(${Se}, ${ye})`,children:[t.jsx("rect",{width:ne*k,height:me*k,fill:"url(#grid)",clipPath:"url(#roomClip)"}),t.jsx("path",{d:Ue,fill:"none",stroke:"#374151",strokeWidth:"3"}),(d||B)&&(g!==null||oe!==null)&&t.jsx(Yn,{wall:B||d,position:oe??g,doorWidth:j||1,roomWidth:ne,roomHeight:me,scale:k,canMove:v()&&!!(S||D),isDragging:(b==null?void 0:b.type)==="door",onDragStart:lt,shape:o,cutoutWidth:l,cutoutHeight:h,cutoutCorner:c}),r.map(w=>{const V=(b==null?void 0:b.type)==="block"&&b.id===w.id,q=w.id===a,H=(b==null?void 0:b.type)==="resize-block"&&b.id===w.id,K=H&&(L==null?void 0:L.id)===w.id?L.width:w.width,R=H&&(L==null?void 0:L.id)===w.id?L.height:w.height,W=V&&($==null?void 0:$.id)===w.id?$.x:w.x,te=V&&($==null?void 0:$.id)===w.id?$.y:w.y;return t.jsxs("g",{transform:`translate(${W*k}, ${te*k}) rotate(${w.rotation}, ${K*k/2}, ${R*k/2})`,className:`block ${q?"selected":""}`,onClick:G=>ce(w.id,G),onMouseDown:G=>ot(w,G),style:{cursor:v()&&(x||N)?"move":"pointer"},children:[t.jsx("rect",{width:K*k,height:R*k,fill:"#4b5563",fillOpacity:V||H?.5:.7,stroke:q?"#ef4444":"#374151",strokeWidth:q?3:1,rx:2}),t.jsx("text",{x:K*k/2,y:R*k/2,textAnchor:"middle",dominantBaseline:"middle",fill:"#e5e7eb",fontSize:Math.min(12,K*k/6),fontWeight:"normal",pointerEvents:"none",children:w.label}),q&&v()&&y&&t.jsx(is,{width:K,height:R,scale:k,onHandleMouseDown:(G,z)=>Ve(w,G,z)})]},`block-${w.id}`)}),n.map(w=>{const V=w.id===Y,q=(b==null?void 0:b.type)==="unit"&&b.id===w.id,H=(b==null?void 0:b.type)==="resize-unit"&&b.id===w.id,K=H&&(L==null?void 0:L.id)===w.id?L.width:w.width,R=H&&(L==null?void 0:L.id)===w.id?L.height:w.height,W=q&&($==null?void 0:$.id)===w.id?$.x:w.x,te=q&&($==null?void 0:$.id)===w.id?$.y:w.y;return t.jsxs("g",{transform:`translate(${W*k}, ${te*k}) rotate(${w.rotation}, ${K*k/2}, ${R*k/2})`,className:`storage-unit ${V?"selected":""}`,onClick:G=>We(w.id,G),onMouseDown:G=>Te(w,G),style:{cursor:v()&&(_||m)?"move":"pointer"},children:[t.jsx("rect",{width:K*k,height:R*k,fill:os[w.type],fillOpacity:q||H?.5:.8,stroke:V?"#1d4ed8":"#fff",strokeWidth:V?3:1,rx:4}),t.jsx("text",{x:K*k/2,y:R*k/2,textAnchor:"middle",dominantBaseline:"middle",fill:"#fff",fontSize:Math.min(14,K*k/5),fontWeight:"bold",pointerEvents:"none",children:w.label}),V&&v()&&u&&t.jsx(is,{width:K,height:R,scale:k,onHandleMouseDown:(G,z)=>Le(w,G,z)})]},w.id)})]}),t.jsxs("g",{transform:`translate(${Ae-120}, 10)`,children:[t.jsx("rect",{x:-5,y:-5,width:115,height:180,fill:"white",fillOpacity:"0.9",rx:4}),t.jsx("text",{x:0,y:10,fontSize:12,fontWeight:"bold",fill:"#374151",children:"Legend"}),Object.entries(os).map(([w,V],q)=>t.jsxs("g",{transform:`translate(0, ${20+q*18})`,children:[t.jsx("rect",{width:12,height:12,fill:V,rx:2}),t.jsx("text",{x:18,y:10,fontSize:11,fill:"#374151",className:"capitalize",children:w})]},w)),t.jsxs("g",{transform:`translate(0, ${20+6*18})`,children:[t.jsx("rect",{width:12,height:12,fill:"#4b5563",rx:2}),t.jsx("text",{x:18,y:10,fontSize:11,fill:"#374151",children:"block"})]}),t.jsxs("g",{transform:`translate(0, ${20+7*18})`,children:[t.jsx("line",{x1:0,y1:6,x2:0,y2:12,stroke:"#374151",strokeWidth:2,strokeLinecap:"round"}),t.jsx("path",{d:"M 0 12 A 6 6 0 0 1 6 6",fill:"none",stroke:"#6b7280",strokeWidth:1}),t.jsx("circle",{cx:0,cy:6,r:2,fill:"#374151"}),t.jsx("text",{x:18,y:10,fontSize:11,fill:"#374151",children:"door"})]})]})]})}function Vn(){const{id:e}=Hs(),[s,n]=ls(),{currentRoom:r,fetchRoom:a,fetchRooms:i,rooms:o,selectedUnitId:l,selectUnit:h,createUnit:c,updateUnit:d,deleteUnit:g,items:j,fetchItems:_,createItem:m,deleteItem:u,moveItem:x,createBlock:N,updateBlock:y,deleteBlock:S,isLoading:D,error:Y}=it(),{canEdit:M,isAuthenticated:v,user:C}=Ce(),[b,U]=E.useState(!1),[Z,re]=E.useState(!1),[B,ee]=E.useState(null);E.useEffect(()=>{v()&&!M()&&re(!0)},[C]);const[oe,Q]=E.useState(!1),[L,J]=E.useState(!1),[$,xe]=E.useState(!1),[le,Ne]=E.useState(!1),[Ae,ve]=E.useState(!1),[ne,me]=E.useState(null),[_e,De]=E.useState({label:"",type:"cabinet",x:0,y:0,width:1,height:1}),[k,Se]=E.useState({label:"",x:0,y:0,width:1,height:1}),[ye,We]=E.useState({label:"",width:1,height:1}),[ce,Te]=E.useState({name:"",unit_catalog_number:"",catalog_number:"",serial_number:"",owned_by:"",description:"",quantity:1,projects:[]}),[ot,lt]=E.useState(""),[Le,Ve]=E.useState(""),[ze,Me]=E.useState(""),[Ke,Ue]=E.useState([]);E.useEffect(()=>(e&&a(e),()=>{h(null)}),[e]),E.useEffect(()=>{const p=s.get("highlight");p&&r&&r.storage_units.some(A=>A.id===p)&&(h(p),n({},{replace:!0}))},[s,r,h,n]),E.useEffect(()=>{i()},[]),E.useEffect(()=>{l&&_(l)},[l]);const w=E.useCallback(p=>{var P;if(p.key==="Backspace"||p.key==="Delete"){const A=p.target;if(A.tagName==="INPUT"||A.tagName==="TEXTAREA"||A.tagName==="SELECT"||!M())return;if(l&&r){const be=r.storage_units.find(ae=>ae.id===l);be&&confirm(`Delete storage unit "${be.label}"? Items in it will be orphaned.`)&&(p.preventDefault(),g(l))}else if(B&&r){const be=(P=r.blocks)==null?void 0:P.find(ae=>ae.id===B);be&&confirm(`Delete block "${be.label}"?`)&&(p.preventDefault(),S(B),ee(null))}}},[l,B,r,M,g,S]);E.useEffect(()=>(document.addEventListener("keydown",w),()=>{document.removeEventListener("keydown",w)}),[w]),E.useEffect(()=>{Le&&o.length>0?o.find(P=>P.id===Le)&&Le===(r==null?void 0:r.id)?Ue((r==null?void 0:r.storage_units.map(P=>({id:P.id,label:P.label})))||[]):r&&Le===r.id?Ue(r.storage_units.map(P=>({id:P.id,label:P.label}))):fetch(`/api/rooms/${Le}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}}).then(P=>P.json()).then(P=>{var A;Ue(((A=P.storage_units)==null?void 0:A.map(be=>({id:be.id,label:be.label})))||[])}).catch(()=>Ue([])):Ue([]),Me("")},[Le,o,r]);const V=async(p,P,A)=>{await d(p,{x:P,y:A})},q=async(p,P)=>{if(r)try{const A=localStorage.getItem("access_token");await fetch(`/api/rooms/${r.id}`,{method:"PUT",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify({door_wall:p,door_position:P})}),a(r.id)}catch(A){console.error("Failed to update door position:",A)}},H=async(p,P,A)=>{await y(p,{x:P,y:A})},K=async(p,P,A)=>{await d(p,{width:P,height:A})},R=async(p,P,A)=>{await y(p,{width:P,height:A})},W=async p=>{p.preventDefault(),e&&(await N({...k,room_id:e}),J(!1),Se({label:"",x:0,y:0,width:1,height:1}))},te=async(p,P)=>{confirm(`Are you sure you want to delete block "${P}"?`)&&await S(p)},G=async p=>{p.preventDefault(),e&&(await c({..._e,room_id:e}),Q(!1),De({label:"",type:"cabinet",x:0,y:0,width:1,height:1}))},z=async p=>{p.preventDefault(),l&&(await d(l,ye),xe(!1))},I=async()=>{!l||!T||confirm(`Are you sure you want to delete "${T.label}"? All items in it will need to be moved first or they will be orphaned.`)&&await g(l)},F=()=>{T&&(We({label:T.label,width:T.width,height:T.height}),xe(!0))},de=async p=>{if(p.preventDefault(),!l)return;const P=ot.split(",").map(A=>A.trim()).filter(A=>A.length>0);await m({...ce,projects:P,storage_unit_id:l}),Ne(!1),Te({name:"",unit_catalog_number:"",catalog_number:"",serial_number:"",owned_by:"",description:"",quantity:1,projects:[]}),lt("")},ue=async(p,P)=>{confirm(`Are you sure you want to delete "${P}"?`)&&await u(p)},ie=p=>{me(p),Ve((r==null?void 0:r.id)||""),Me(""),ve(!0)},ge=async p=>{p.preventDefault(),!(!ne||!ze)&&(await x(ne.id,{to_storage_unit_id:ze,reason:"Moved via UI"}),ve(!1),me(null),Ve(""),Me(""))},T=r==null?void 0:r.storage_units.find(p=>p.id===l);return Z?t.jsx("div",{className:"text-center py-12",children:t.jsxs("div",{className:"card max-w-md mx-auto",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Access Restricted"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"You need Editor or Admin permissions to view room details, storage units, and items."}),t.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"As a Viewer, you can only see the list of rooms. Contact an administrator to request elevated access."}),t.jsx($e,{to:"/rooms",className:"btn-primary",children:"Back to Rooms"})]})}):D&&!r?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),t.jsx("p",{className:"mt-2 text-gray-500",children:"Loading room..."})]}):r?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx($e,{to:"/rooms",className:"text-sm text-gray-500 hover:text-gray-700",children:"â† Back to rooms"}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 mt-1",children:r.name}),r.building&&t.jsx("p",{className:"text-gray-600",children:r.building})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:async()=>{try{const p=localStorage.getItem("access_token"),P=await fetch(`/api/rooms/${r.id}/export`,{headers:{Authorization:`Bearer ${p}`}});if(!P.ok)throw new Error("Export failed");const A=await P.blob(),be=window.URL.createObjectURL(A),ae=document.createElement("a");ae.href=be,ae.download=`${r.name.replace(/\s+/g,"_")}_inventory.csv`,document.body.appendChild(ae),ae.click(),window.URL.revokeObjectURL(be),document.body.removeChild(ae)}catch(p){console.error("Export failed:",p)}},className:"btn-secondary",children:"Export CSV"}),M()&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>J(!0),className:"btn-secondary",children:"+ Add Block"}),t.jsx("button",{onClick:()=>Q(!0),className:"btn-primary",children:"+ Add Storage Unit"})]})]})]}),Y&&t.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-700",children:Y}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Room Layout"}),t.jsx(Jn,{width:r.width||10,height:r.height||10,units:r.storage_units,blocks:r.blocks||[],selectedBlockId:B,onBlockSelect:ee,shape:r.shape,shapeCutoutWidth:r.shape_cutout_width,shapeCutoutHeight:r.shape_cutout_height,shapeCutoutCorner:r.shape_cutout_corner,doorWall:r.door_wall,doorPosition:r.door_position,doorWidth:r.door_width,onUnitMoveEnd:M()?V:void 0,onUnitResize:M()?K:void 0,onBlockMoveEnd:M()?H:void 0,onBlockResize:M()?R:void 0,onDoorMoveEnd:M()?q:void 0}),t.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Click a storage unit to view its items.",M()&&" Drag to reposition. Press Backspace to delete selected."]})]})}),t.jsxs("div",{children:[T?t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:T.label}),t.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:["Type: ",T.type]}),t.jsxs("p",{className:"text-sm text-gray-400",children:["Size: ",T.width,"m x ",T.height,"m"]})]}),M()&&t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:F,className:"text-blue-600 hover:text-blue-800 text-sm",children:"Edit"}),t.jsx("button",{onClick:I,className:"text-red-500 hover:text-red-700 text-sm",children:"Delete"})]})]}),M()&&t.jsx("button",{onClick:()=>Ne(!0),className:"btn-primary text-sm w-full mb-4",children:"+ Add Item"}),t.jsxs("h3",{className:"font-medium mb-2",children:["Items (",j.length,")"]}),j.length===0?t.jsx("p",{className:"text-sm text-gray-500",children:"No items in this unit"}):t.jsx("ul",{className:"space-y-2 max-h-96 overflow-auto",children:j.map(p=>t.jsx("li",{className:"p-2 bg-gray-50 rounded text-sm",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium",children:p.name}),p.unit_catalog_number&&t.jsxs("p",{className:"text-gray-500 text-xs",children:["Unit Cat #: ",p.unit_catalog_number]}),p.catalog_number&&t.jsxs("p",{className:"text-gray-500 text-xs",children:["Cat #: ",p.catalog_number]}),p.serial_number&&t.jsxs("p",{className:"text-gray-500 text-xs",children:["S/N: ",p.serial_number]}),p.owned_by&&t.jsxs("p",{className:"text-gray-500 text-xs",children:["Owner: ",p.owned_by]}),p.projects&&p.projects.length>0&&t.jsxs("p",{className:"text-gray-500 text-xs",children:["Projects: ",p.projects.join(", ")]}),t.jsxs("p",{className:"text-gray-400 text-xs",children:["Qty: ",p.quantity]})]}),M()&&t.jsxs("div",{className:"flex flex-col gap-1 ml-2",children:[t.jsx("button",{onClick:()=>ie(p),className:"text-blue-500 hover:text-blue-700 text-xs",children:"Move"}),t.jsx("button",{onClick:()=>ue(p.id,p.name),className:"text-red-500 hover:text-red-700 text-xs",children:"Delete"})]})]})},p.id))})]}):t.jsx("div",{className:"card",children:t.jsx("p",{className:"text-gray-500 text-center py-8",children:"Select a storage unit to view items"})}),t.jsxs("div",{className:"card mt-4",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Storage Units (",r.storage_units.length,")"]}),r.storage_units.length===0?t.jsx("p",{className:"text-sm text-gray-500",children:"No storage units yet"}):t.jsx("ul",{className:"space-y-2",children:r.storage_units.map(p=>t.jsxs("li",{onClick:()=>h(p.id),className:`p-2 rounded cursor-pointer ${p.id===l?"bg-primary-50 border border-primary-200":"bg-gray-50 hover:bg-gray-100"}`,children:[t.jsx("p",{className:"font-medium",children:p.label}),t.jsx("p",{className:"text-xs text-gray-500 capitalize",children:p.type})]},p.id))})]}),r.blocks&&r.blocks.length>0&&t.jsxs("div",{className:"card mt-4",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4",children:["Blocks (",r.blocks.length,")"]}),t.jsx("ul",{className:"space-y-2",children:r.blocks.map(p=>t.jsxs("li",{className:"p-2 bg-gray-100 rounded flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-700",children:p.label}),t.jsxs("p",{className:"text-xs text-gray-500",children:[p.width,"m x ",p.height,"m"]})]}),M()&&t.jsx("button",{onClick:()=>te(p.id,p.label),className:"text-red-500 hover:text-red-700 text-xs",children:"Delete"})]},p.id))})]})]})]}),oe&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Storage Unit"}),t.jsxs("form",{onSubmit:G,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"label",className:"label",children:"Label *"}),t.jsx("input",{id:"label",type:"text",value:_e.label,onChange:p=>De({..._e,label:p.target.value}),className:"input",required:!0,autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"type",className:"label",children:"Type"}),t.jsxs("select",{id:"type",value:_e.type,onChange:p=>De({..._e,type:p.target.value}),className:"input",children:[t.jsx("option",{value:"cabinet",children:"Cabinet"}),t.jsx("option",{value:"desk",children:"Desk"}),t.jsx("option",{value:"shelf",children:"Shelf"}),t.jsx("option",{value:"drawer",children:"Drawer"}),t.jsx("option",{value:"box",children:"Box"}),t.jsx("option",{value:"other",children:"Other"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"width",className:"label",children:"Width (m)"}),t.jsx("input",{id:"width",type:"number",value:_e.width,onChange:p=>De({..._e,width:Number(p.target.value)}),className:"input",min:"0.1",step:"0.1"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"height",className:"label",children:"Height (m)"}),t.jsx("input",{id:"height",type:"number",value:_e.height,onChange:p=>De({..._e,height:Number(p.target.value)}),className:"input",min:"0.1",step:"0.1"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{type:"button",onClick:()=>Q(!1),className:"btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn-primary",children:"Add Unit"})]})]})]})}),L&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Block"}),t.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Blocks are visual obstacles (like furniture or pillars) that cannot hold items."}),t.jsxs("form",{onSubmit:W,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"blockLabel",className:"label",children:"Label *"}),t.jsx("input",{id:"blockLabel",type:"text",value:k.label,onChange:p=>Se({...k,label:p.target.value}),className:"input",required:!0,autoFocus:!0,placeholder:"e.g., Pillar, Table, Window"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"blockWidth",className:"label",children:"Width (m)"}),t.jsx("input",{id:"blockWidth",type:"number",value:k.width,onChange:p=>Se({...k,width:Number(p.target.value)}),className:"input",min:"0.1",step:"0.1"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"blockHeight",className:"label",children:"Height (m)"}),t.jsx("input",{id:"blockHeight",type:"number",value:k.height,onChange:p=>Se({...k,height:Number(p.target.value)}),className:"input",min:"0.1",step:"0.1"})]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{type:"button",onClick:()=>J(!1),className:"btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn-primary",children:"Add Block"})]})]})]})}),$&&T&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Storage Unit"}),t.jsxs("form",{onSubmit:z,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"editLabel",className:"label",children:"Label *"}),t.jsx("input",{id:"editLabel",type:"text",value:ye.label,onChange:p=>We({...ye,label:p.target.value}),className:"input",required:!0,autoFocus:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"editWidth",className:"label",children:"Width (m)"}),t.jsx("input",{id:"editWidth",type:"number",value:ye.width,onChange:p=>We({...ye,width:Number(p.target.value)}),className:"input",min:"0.1",step:"0.1"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"editHeight",className:"label",children:"Height (m)"}),t.jsx("input",{id:"editHeight",type:"number",value:ye.height,onChange:p=>We({...ye,height:Number(p.target.value)}),className:"input",min:"0.1",step:"0.1"})]})]}),t.jsx("p",{className:"text-sm text-gray-500",children:"Note: Items in this unit will not be affected."}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{type:"button",onClick:()=>xe(!1),className:"btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn-primary",children:"Save Changes"})]})]})]})}),le&&T&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Add Item to ",T.label]}),t.jsxs("form",{onSubmit:de,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"itemName",className:"label",children:"Name *"}),t.jsx("input",{id:"itemName",type:"text",value:ce.name,onChange:p=>Te({...ce,name:p.target.value}),className:"input",required:!0,autoFocus:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"unitCatalogNumber",className:"label",children:"Unit Catalog Number"}),t.jsx("input",{id:"unitCatalogNumber",type:"text",value:ce.unit_catalog_number,onChange:p=>Te({...ce,unit_catalog_number:p.target.value}),className:"input"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"catalogNumber",className:"label",children:"Catalog Number"}),t.jsx("input",{id:"catalogNumber",type:"text",value:ce.catalog_number,onChange:p=>Te({...ce,catalog_number:p.target.value}),className:"input"})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"serialNumber",className:"label",children:"Serial Number"}),t.jsx("input",{id:"serialNumber",type:"text",value:ce.serial_number,onChange:p=>Te({...ce,serial_number:p.target.value}),className:"input"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"ownedBy",className:"label",children:"Owned By"}),t.jsx("input",{id:"ownedBy",type:"text",value:ce.owned_by,onChange:p=>Te({...ce,owned_by:p.target.value}),className:"input"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"quantity",className:"label",children:"Quantity"}),t.jsx("input",{id:"quantity",type:"number",value:ce.quantity,onChange:p=>Te({...ce,quantity:Number(p.target.value)}),className:"input",min:"1"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"projects",className:"label",children:"Projects"}),t.jsx("input",{id:"projects",type:"text",value:ot,onChange:p=>lt(p.target.value),className:"input",placeholder:"e.g., Project A, Project B"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Comma-separated list of projects"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"description",className:"label",children:"Description"}),t.jsx("textarea",{id:"description",value:ce.description,onChange:p=>Te({...ce,description:p.target.value}),className:"input",rows:3})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{type:"button",onClick:()=>Ne(!1),className:"btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn-primary",children:"Add Item"})]})]})]})}),Ae&&ne&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"Move Item"}),t.jsxs("p",{className:"text-gray-600 mb-4",children:["Moving: ",t.jsx("span",{className:"font-medium",children:ne.name})]}),t.jsxs("form",{onSubmit:ge,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"targetRoom",className:"label",children:"Target Room *"}),t.jsxs("select",{id:"targetRoom",value:Le,onChange:p=>Ve(p.target.value),className:"input",required:!0,children:[t.jsx("option",{value:"",children:"Select a room..."}),o.map(p=>t.jsxs("option",{value:p.id,children:[p.name," ",p.building?`(${p.building})`:""]},p.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"targetUnit",className:"label",children:"Target Storage Unit *"}),t.jsxs("select",{id:"targetUnit",value:ze,onChange:p=>Me(p.target.value),className:"input",required:!0,disabled:!Le||Ke.length===0,children:[t.jsx("option",{value:"",children:Le?Ke.length===0?"No storage units in this room":"Select a storage unit...":"Select a room first..."}),Ke.filter(p=>p.id!==l).map(p=>t.jsx("option",{value:p.id,children:p.label},p.id))]})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{type:"button",onClick:()=>{ve(!1),me(null)},className:"btn-secondary",children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn-primary",disabled:!ze,children:"Move Item"})]})]})]})}),t.jsx(Mt,{isOpen:b,onClose:()=>U(!1),message:"You need to sign in to make changes to the inventory."})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-gray-500",children:"Room not found"}),t.jsx($e,{to:"/rooms",className:"text-primary-600 hover:underline mt-2 block",children:"Back to rooms"})]})}function Kn(){const{searchResults:e,searchTotal:s,searchItems:n,clearSearch:r,isLoading:a,error:i}=it(),{canEdit:o,isAuthenticated:l}=Ce(),[h,c]=E.useState(""),[d,g]=E.useState(!1);if(l()&&!o())return t.jsx("div",{className:"text-center py-12",children:t.jsxs("div",{className:"card max-w-md mx-auto",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Access Restricted"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"You need Editor or Admin permissions to search for items."}),t.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"As a Viewer, you can only see the list of rooms. Contact an administrator to request elevated access."}),t.jsx($e,{to:"/rooms",className:"btn-primary",children:"Back to Rooms"})]})});const j=async m=>{m.preventDefault(),h.trim()&&(await n(h),g(!0))},_=()=>{c(""),g(!1),r()};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Search Items"}),t.jsx("p",{className:"text-gray-600",children:"Find items by name, catalog number, or description"})]}),t.jsx("div",{className:"card",children:t.jsxs("form",{onSubmit:j,className:"flex gap-4",children:[t.jsx("input",{type:"text",value:h,onChange:m=>c(m.target.value),placeholder:"Enter item name or catalog number...",className:"input flex-1",autoFocus:!0}),t.jsx("button",{type:"submit",className:"btn-primary",disabled:a,children:a?"Searching...":"Search"}),d&&t.jsx("button",{type:"button",onClick:_,className:"btn-secondary",children:"Clear"})]})}),i&&t.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-700",children:i}),d&&t.jsxs("div",{className:"card",children:[t.jsx("div",{className:"flex justify-between items-center mb-4",children:t.jsxs("h2",{className:"text-lg font-semibold",children:["Results ",s>0&&`(${s})`]})}),a?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"}),t.jsx("p",{className:"mt-2 text-gray-500",children:"Searching..."})]}):e.length===0?t.jsx("div",{className:"text-center py-8",children:t.jsxs("p",{className:"text-gray-500",children:['No items found matching "',h,'"']})}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b text-left",children:[t.jsx("th",{className:"pb-2 font-semibold",children:"Name"}),t.jsx("th",{className:"pb-2 font-semibold",children:"Unit Cat #"}),t.jsx("th",{className:"pb-2 font-semibold",children:"Cat #"}),t.jsx("th",{className:"pb-2 font-semibold",children:"Location"}),t.jsx("th",{className:"pb-2 font-semibold",children:"Qty"})]})}),t.jsx("tbody",{children:e.map(m=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsxs("td",{className:"py-3",children:[t.jsx("p",{className:"font-medium",children:m.name}),m.description&&t.jsx("p",{className:"text-sm text-gray-500 truncate max-w-xs",children:m.description})]}),t.jsx("td",{className:"py-3",children:m.unit_catalog_number||"-"}),t.jsx("td",{className:"py-3",children:m.catalog_number||"-"}),t.jsx("td",{className:"py-3",children:m.room_id?t.jsxs($e,{to:`/rooms/${m.room_id}?highlight=${m.storage_unit_id||""}`,className:"block text-sm hover:bg-primary-50 rounded p-1 -m-1 transition-colors",children:[m.room_name&&t.jsx("p",{className:"text-primary-600 hover:text-primary-700 font-medium",children:m.room_name}),m.storage_unit_label&&t.jsx("p",{className:"text-gray-600",children:m.storage_unit_label}),m.compartment_name&&t.jsx("p",{className:"text-gray-500",children:m.compartment_name})]}):t.jsx("div",{className:"text-sm text-gray-400",children:"No location"})}),t.jsx("td",{className:"py-3",children:m.quantity})]},m.id))})]})}),s>e.length&&t.jsxs("p",{className:"text-sm text-gray-500 mt-4 text-center",children:["Showing ",e.length," of ",s," results"]})]}),!d&&t.jsxs("div",{className:"card bg-gray-50",children:[t.jsx("h3",{className:"font-semibold mb-2",children:"Search Tips"}),t.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[t.jsx("li",{children:'â€¢ Search by item name (e.g., "screwdriver")'}),t.jsx("li",{children:'â€¢ Search by catalog number (e.g., "ABC-123")'}),t.jsx("li",{children:"â€¢ Partial matches are supported"}),t.jsx("li",{children:"â€¢ Search is case-insensitive"})]})]})]})}function Zn(){const[e,s]=E.useState([]),[n,r]=E.useState(null),[a,i]=E.useState(!0),[o,l]=E.useState(null);E.useEffect(()=>{const d=async()=>{try{const[j,_]=await Promise.all([Re.listUsers(),Re.getStats()]);s(j),r(_)}catch(j){l("Failed to load admin data"),console.error(j)}finally{i(!1)}};d();const g=setInterval(d,3e4);return()=>clearInterval(g)},[]);const h=async(d,g)=>{try{await Re.updateUser(d,{role:g}),s(e.map(j=>j.id===d?{...j,role:g}:j))}catch(j){console.error("Failed to update role:",j)}},c=async(d,g)=>{try{await Re.updateUser(d,{is_active:!g}),s(e.map(j=>j.id===d?{...j,is_active:!g}:j))}catch(j){console.error("Failed to toggle user status:",j)}};return a?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):t.jsxs("div",{className:"space-y-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),o&&t.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-700",children:o}),n&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-green-600",children:n.online_users}),t.jsx("p",{className:"text-sm text-gray-500",children:"Online Now"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-primary-600",children:n.total_users}),t.jsx("p",{className:"text-sm text-gray-500",children:"Total Users"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-blue-600",children:n.total_rooms}),t.jsx("p",{className:"text-sm text-gray-500",children:"Rooms"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-purple-600",children:n.total_storage_units}),t.jsx("p",{className:"text-sm text-gray-500",children:"Storage Units"})]}),t.jsxs("div",{className:"card text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-orange-600",children:n.total_items}),t.jsx("p",{className:"text-sm text-gray-500",children:"Items"})]})]}),n&&n.top_editors.length>0&&t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Top Contributors"}),t.jsx("div",{className:"flex flex-wrap gap-3",children:n.top_editors.map((d,g)=>t.jsxs("div",{className:`px-4 py-2 rounded-full ${g===0?"bg-yellow-100 text-yellow-800":g===1?"bg-gray-100 text-gray-800":g===2?"bg-orange-100 text-orange-800":"bg-blue-50 text-blue-800"}`,children:[t.jsx("span",{className:"font-medium",children:d.username}),t.jsxs("span",{className:"ml-2 text-sm opacity-75",children:[d.edit_count," edits"]})]},d.username))})]}),t.jsxs("div",{className:"card",children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:"User Management"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b text-left",children:[t.jsx("th",{className:"pb-3 font-semibold",children:"Status"}),t.jsx("th",{className:"pb-3 font-semibold",children:"User"}),t.jsx("th",{className:"pb-3 font-semibold",children:"Role"}),t.jsx("th",{className:"pb-3 font-semibold",children:"Edits"}),t.jsx("th",{className:"pb-3 font-semibold",children:"Last Active"}),t.jsx("th",{className:"pb-3 font-semibold",children:"Actions"})]})}),t.jsx("tbody",{children:e.map(d=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-3",children:t.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${d.is_online?"bg-green-500":"bg-gray-300"}`,title:d.is_online?"Online":"Offline"})}),t.jsx("td",{className:"py-3",children:t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:d.username}),t.jsx("p",{className:"text-sm text-gray-500",children:d.email})]})}),t.jsx("td",{className:"py-3",children:t.jsxs("select",{value:d.role,onChange:g=>h(d.id,g.target.value),className:"input py-1 px-2 text-sm w-24",disabled:d.role==="admin",children:[t.jsx("option",{value:"viewer",children:"Viewer"}),t.jsx("option",{value:"editor",children:"Editor"}),t.jsx("option",{value:"admin",children:"Admin"})]})}),t.jsx("td",{className:"py-3",children:t.jsx("span",{className:"text-sm",children:d.edit_count})}),t.jsx("td",{className:"py-3",children:t.jsx("span",{className:"text-sm text-gray-500",children:d.last_active?new Date(d.last_active).toLocaleString():"Never"})}),t.jsx("td",{className:"py-3",children:d.role!=="admin"&&t.jsx("button",{onClick:()=>c(d.id,d.is_active),className:`text-sm ${d.is_active?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"}`,children:d.is_active?"Disable":"Enable"})})]},d.id))})]})})]})]})}function Gn(){const{fetchUser:e,token:s,user:n,isLoading:r}=Ce();return E.useEffect(()=>{s&&!n&&e()},[s,n,e]),s&&!n&&r?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),t.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):t.jsx(Ws,{children:t.jsxs(zs,{children:[t.jsx(Fe,{path:"/login",element:t.jsx(Dn,{})}),t.jsxs(Fe,{path:"/",element:t.jsx(Pn,{}),children:[t.jsx(Fe,{index:!0,element:t.jsx(Mn,{})}),t.jsx(Fe,{path:"rooms",element:t.jsx(ht,{children:t.jsx(qn,{})})}),t.jsx(Fe,{path:"rooms/:id",element:t.jsx(ht,{children:t.jsx(Vn,{})})}),t.jsx(Fe,{path:"search",element:t.jsx(ht,{children:t.jsx(Kn,{})})}),t.jsx(Fe,{path:"admin",element:t.jsx(ht,{requireAdmin:!0,children:t.jsx(Zn,{})})})]}),t.jsx(Fe,{path:"*",element:t.jsx($t,{to:"/",replace:!0})})]})})}kt.createRoot(document.getElementById("root")).render(t.jsx(qs.StrictMode,{children:t.jsx(Gn,{})}));
